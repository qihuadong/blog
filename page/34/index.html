<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/blog/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/blog/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/blog/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/blog/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/blog/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/blog/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/blog/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">





  <link rel="alternate" href="/blog/atom.xml" title="张鹏的博客" type="application/atom+xml">






<meta property="og:type" content="website">
<meta property="og:title" content="张鹏的博客">
<meta property="og:url" content="https://dunwu.github.io/page/34/index.html">
<meta property="og:site_name" content="张鹏的博客">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="张鹏的博客">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/blog/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://dunwu.github.io/page/34/">





  <title>张鹏的博客 - 大道至简，知易行难</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/blog/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">张鹏的博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">大道至简，知易行难</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/blog/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/blog/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/blog/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/blog/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/blog/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dunwu.github.io/blog/2017/11/08/programming/java/javaweb/javaee/jstl/jstl-format/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zhang Peng">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="张鹏的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/2017/11/08/programming/java/javaweb/javaee/jstl/jstl-format/" itemprop="url">JSTL 格式化标签</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-11-08T00:00:00+08:00">
                2017-11-08
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/javaee/" itemprop="url" rel="index">
                    <span itemprop="name">javaee</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>JSTL 格式化标签用来格式化并输出文本、日期、时间、数字。引用格式化标签库的语法如下：</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ taglib prefix=<span class="string">"fmt"</span></span><br><span class="line">           uri=<span class="string">"http://java.sun.com/jsp/jstl/fmt"</span> %&gt;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>标签</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>&lt;fmt:formatNumber&gt;</code></td>
<td>使用指定的格式或精度格式化数字</td>
</tr>
<tr>
<td><code>&lt;fmt:parseNumber&gt;</code></td>
<td>解析一个代表着数字，货币或百分比的字符串</td>
</tr>
<tr>
<td><code>&lt;fmt:formatDate&gt;</code></td>
<td>使用指定的风格或模式格式化日期和时间</td>
</tr>
<tr>
<td><code>&lt;fmt:parseDate&gt;</code></td>
<td>解析一个代表着日期或时间的字符串</td>
</tr>
<tr>
<td><code>&lt;fmt:bundle&gt;</code></td>
<td>绑定资源</td>
</tr>
<tr>
<td><code>&lt;fmt:setLocale&gt;</code></td>
<td>指定地区</td>
</tr>
<tr>
<td><code>&lt;fmt:setBundle&gt;</code></td>
<td>绑定资源</td>
</tr>
<tr>
<td><code>&lt;fmt:timeZone&gt;</code></td>
<td>指定时区</td>
</tr>
<tr>
<td><code>&lt;fmt:setTimeZone&gt;</code></td>
<td>指定时区</td>
</tr>
<tr>
<td><code>&lt;fmt:message&gt;</code></td>
<td>显示资源配置文件信息</td>
</tr>
<tr>
<td><code>&lt;fmt:requestEncoding&gt;</code></td>
<td>设置 request 的字符编码</td>
</tr>
</tbody>
</table>
<h2 id="lt-fmt-formatNumber-gt-标签"><a href="#lt-fmt-formatNumber-gt-标签" class="headerlink" title="&lt;fmt:formatNumber&gt;标签"></a><code>&lt;fmt:formatNumber&gt;</code>标签</h2><p><code>&lt;fmt:formatNumber&gt;</code>标签用于格式化数字，百分比，货币。</p>
<h3 id="语法格式"><a href="#语法格式" class="headerlink" title="语法格式"></a>语法格式</h3><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;fmt:formatNumber</span><br><span class="line">  value=<span class="string">"&lt;string&gt;"</span></span><br><span class="line">  type=<span class="string">"&lt;string&gt;"</span></span><br><span class="line">  pattern=<span class="string">"&lt;string&gt;"</span></span><br><span class="line">  currencyCode=<span class="string">"&lt;string&gt;"</span></span><br><span class="line">  currencySymbol=<span class="string">"&lt;string&gt;"</span></span><br><span class="line">  groupingUsed=<span class="string">"&lt;string&gt;"</span></span><br><span class="line">  maxIntegerDigits=<span class="string">"&lt;string&gt;"</span></span><br><span class="line">  minIntegerDigits=<span class="string">"&lt;string&gt;"</span></span><br><span class="line">  maxFractionDigits=<span class="string">"&lt;string&gt;"</span></span><br><span class="line">  minFractionDigits=<span class="string">"&lt;string&gt;"</span></span><br><span class="line">  <span class="keyword">var</span>=<span class="string">"&lt;string&gt;"</span></span><br><span class="line">  scope=<span class="string">"&lt;string&gt;"</span>/&gt;</span><br></pre></td></tr></table></figure>
<h3 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h3><p><code>&lt;fmt:formatNumber&gt;</code>标签有如下属性：</p>
<table>
<thead>
<tr>
<th><strong>属性</strong></th>
<th><strong>描述</strong></th>
<th><strong>是否必要</strong></th>
<th><strong>默认值</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>value</td>
<td>要显示的数字</td>
<td>是</td>
<td>无</td>
</tr>
<tr>
<td>type</td>
<td>NUMBER，CURRENCY，或 PERCENT 类型</td>
<td>否</td>
<td>Number</td>
</tr>
<tr>
<td>pattern</td>
<td>指定一个自定义的格式化模式用与输出</td>
<td>否</td>
<td>无</td>
</tr>
<tr>
<td>currencyCode</td>
<td>货币码（当 type=”currency”时）</td>
<td>否</td>
<td>取决于默认区域</td>
</tr>
<tr>
<td>currencySymbol</td>
<td>货币符号 (当 type=”currency”时)</td>
<td>否</td>
<td>取决于默认区域</td>
</tr>
<tr>
<td>groupingUsed</td>
<td>是否对数字分组 (TRUE 或 FALSE)</td>
<td>否</td>
<td>true</td>
</tr>
<tr>
<td>maxIntegerDigits</td>
<td>整型数最大的位数</td>
<td>否</td>
<td>无</td>
</tr>
<tr>
<td>minIntegerDigits</td>
<td>整型数最小的位数</td>
<td>否</td>
<td>无</td>
</tr>
<tr>
<td>maxFractionDigits</td>
<td>小数点后最大的位数</td>
<td>否</td>
<td>无</td>
</tr>
<tr>
<td>minFractionDigits</td>
<td>小数点后最小的位数</td>
<td>否</td>
<td>无</td>
</tr>
<tr>
<td>var</td>
<td>存储格式化数字的变量</td>
<td>否</td>
<td>Print to page</td>
</tr>
<tr>
<td>scope</td>
<td>var 属性的作用域</td>
<td>否</td>
<td>page</td>
</tr>
</tbody>
</table>
<p>如果<code>type</code>属性为 percent 或 number，那么您就可以使用其它几个格式化数字属性。</p>
<p><code>maxIntegerDigits</code>属性和<code>minIntegerDigits</code>属性允许您指定整数的长度。若实际数字超过了<code>maxIntegerDigits</code>所指定的最大值，则数字将会被截断。</p>
<p>有一些属性允许您指定小数点后的位数。<code>minFractionalDigits</code>属性和<code>maxFractionalDigits</code>属性允许您指定小数点后的位数。若实际的数字超出了所指定的范围，则这个数字会被截断。</p>
<p>数字分组可以用来在每三个数字中插入一个逗号。<code>groupingIsUsed</code>属性用来指定是否使用数字分组。当与<code>minIntegerDigits</code>属性一同使用时，就必须要很小心地来获取预期的结果了。</p>
<p>您或许会使用<code>pattern</code>属性。这个属性可以让您在对数字编码时包含指定的字符。接下来的表格中列出了这些字符。</p>
<table>
<thead>
<tr>
<th><strong>符号</strong></th>
<th><strong>描述</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>代表一位数字</td>
</tr>
<tr>
<td>E</td>
<td>使用指数格式</td>
</tr>
<tr>
<td>#</td>
<td>代表一位数字，若没有则显示 0</td>
</tr>
<tr>
<td>.</td>
<td>小数点</td>
</tr>
<tr>
<td>,</td>
<td>数字分组分隔符</td>
</tr>
<tr>
<td>;</td>
<td>分隔格式</td>
</tr>
<tr>
<td>-</td>
<td>使用默认负数前缀</td>
</tr>
<tr>
<td>%</td>
<td>百分数</td>
</tr>
<tr>
<td>?</td>
<td>千分数</td>
</tr>
<tr>
<td>¤</td>
<td>货币符号，使用实际的货币符号代替</td>
</tr>
<tr>
<td>X</td>
<td>指定可以作为前缀或后缀的字符</td>
</tr>
<tr>
<td>‘</td>
<td>在前缀或后缀中引用特殊字符</td>
</tr>
</tbody>
</table>
<h2 id="lt-fmt-parseNumber-gt-标签"><a href="#lt-fmt-parseNumber-gt-标签" class="headerlink" title="&lt;fmt:parseNumber&gt; 标签"></a><code>&lt;fmt:parseNumber&gt;</code> 标签</h2><p><code>&lt;fmt:parseNumber&gt;</code>标签用来解析数字，百分数，货币。</p>
<h3 id="语法格式-1"><a href="#语法格式-1" class="headerlink" title="语法格式"></a>语法格式</h3><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;fmt:parseNumber</span><br><span class="line">  value=<span class="string">"&lt;string&gt;"</span></span><br><span class="line">  type=<span class="string">"&lt;string&gt;"</span></span><br><span class="line">  pattern=<span class="string">"&lt;string&gt;"</span></span><br><span class="line">  parseLocale=<span class="string">"&lt;string&gt;"</span></span><br><span class="line">  integerOnly=<span class="string">"&lt;string&gt;"</span></span><br><span class="line">  <span class="keyword">var</span>=<span class="string">"&lt;string&gt;"</span></span><br><span class="line">  scope=<span class="string">"&lt;string&gt;"</span>/&gt;</span><br></pre></td></tr></table></figure>
<h3 id="属性-1"><a href="#属性-1" class="headerlink" title="属性"></a>属性</h3><p><code>&lt;fmt:parseNumber&gt;</code>标签有如下属性：</p>
<table>
<thead>
<tr>
<th><strong>属性</strong></th>
<th><strong>描述</strong></th>
<th><strong>是否必要</strong></th>
<th><strong>默认值</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>value</td>
<td>要解析的数字</td>
<td>否</td>
<td>Body</td>
</tr>
<tr>
<td>type</td>
<td>NUMBER,，CURRENCY，或 PERCENT</td>
<td>否</td>
<td>number</td>
</tr>
<tr>
<td>parseLocale</td>
<td>解析数字时所用的区域</td>
<td>否</td>
<td>默认区域</td>
</tr>
<tr>
<td>integerOnly</td>
<td>是否只解析整型数（true）或浮点数（false）</td>
<td>否</td>
<td>false</td>
</tr>
<tr>
<td>pattern</td>
<td>自定义解析模式</td>
<td>否</td>
<td>无</td>
</tr>
<tr>
<td>timeZone</td>
<td>要显示的日期的时区</td>
<td>否</td>
<td>默认时区</td>
</tr>
<tr>
<td>var</td>
<td>存储待解析数字的变量</td>
<td>否</td>
<td>Print to page</td>
</tr>
<tr>
<td>scope</td>
<td>var 属性的作用域</td>
<td>否</td>
<td>page</td>
</tr>
</tbody>
</table>
<p><code>pattern</code>属性与<code>&lt;fmt:formatNumber&gt;</code>标签中的<code>pattern</code>有相同的作用。在解析时，<code>pattern</code>属性告诉解析器期望的格式。</p>
<h2 id="lt-fmt-formatDate-gt-标签"><a href="#lt-fmt-formatDate-gt-标签" class="headerlink" title="&lt;fmt:formatDate&gt; 标签"></a><code>&lt;fmt:formatDate&gt;</code> 标签</h2><p><code>&lt;fmt:formatDate&gt;</code>标签用于使用不同的方式格式化日期。</p>
<h3 id="语法格式-2"><a href="#语法格式-2" class="headerlink" title="语法格式"></a>语法格式</h3><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;fmt:formatDate</span><br><span class="line">  value=<span class="string">"&lt;string&gt;"</span></span><br><span class="line">  type=<span class="string">"&lt;string&gt;"</span></span><br><span class="line">  dateStyle=<span class="string">"&lt;string&gt;"</span></span><br><span class="line">  timeStyle=<span class="string">"&lt;string&gt;"</span></span><br><span class="line">  pattern=<span class="string">"&lt;string&gt;"</span></span><br><span class="line">  timeZone=<span class="string">"&lt;string&gt;"</span></span><br><span class="line">  <span class="keyword">var</span>=<span class="string">"&lt;string&gt;"</span></span><br><span class="line">  scope=<span class="string">"&lt;string&gt;"</span>/&gt;</span><br></pre></td></tr></table></figure>
<h3 id="属性-2"><a href="#属性-2" class="headerlink" title="属性"></a>属性</h3><p><code>&lt;fmt:formatDate&gt;</code>标签有如下属性：</p>
<table>
<thead>
<tr>
<th>属性</th>
<th>描述</th>
<th>是否必要</th>
<th>默认值</th>
</tr>
</thead>
<tbody>
<tr>
<td>value</td>
<td>要显示的日期</td>
<td>是</td>
<td>无</td>
</tr>
<tr>
<td>type</td>
<td>DATE, TIME, 或 BOTH</td>
<td>否</td>
<td>date</td>
</tr>
<tr>
<td>dateStyle</td>
<td>FULL, LONG, MEDIUM, SHORT, 或 DEFAULT</td>
<td>否</td>
<td>default</td>
</tr>
<tr>
<td>timeStyle</td>
<td>FULL, LONG, MEDIUM, SHORT, 或 DEFAULT</td>
<td>否</td>
<td>default</td>
</tr>
<tr>
<td>pattern</td>
<td>自定义格式模式</td>
<td>否</td>
<td>无</td>
</tr>
<tr>
<td>timeZone</td>
<td>显示日期的时区</td>
<td>否</td>
<td>默认时区</td>
</tr>
<tr>
<td>var</td>
<td>存储格式化日期的变量名</td>
<td>否</td>
<td>显示在页面</td>
</tr>
<tr>
<td>scope</td>
<td>存储格式化日志变量的范围</td>
<td>否</td>
<td>页面</td>
</tr>
</tbody>
</table>
<p><code>&lt;fmt:formatDate&gt;</code> 标签格式模式</p>
<table>
<thead>
<tr>
<th>代码</th>
<th>描述</th>
<th>实例</th>
</tr>
</thead>
<tbody>
<tr>
<td>G</td>
<td>时代标志</td>
<td>AD</td>
</tr>
<tr>
<td>y</td>
<td>不包含纪元的年份。如果不包含纪元的年份小于 10，则显示不具有前导零的年份。</td>
<td>2002</td>
</tr>
<tr>
<td>M</td>
<td>月份数字。一位数的月份没有前导零。</td>
<td>April &amp; 04</td>
</tr>
<tr>
<td>d</td>
<td>月中的某一天。一位数的日期没有前导零。</td>
<td>20</td>
</tr>
<tr>
<td>h</td>
<td>12 小时制的小时。一位数的小时数没有前导零。</td>
<td>12</td>
</tr>
<tr>
<td>H</td>
<td>24 小时制的小时。一位数的小时数没有前导零。</td>
<td>0</td>
</tr>
<tr>
<td>m</td>
<td>分钟。一位数的分钟数没有前导零。</td>
<td>45</td>
</tr>
<tr>
<td>s</td>
<td>秒。一位数的秒数没有前导零。</td>
<td>52</td>
</tr>
<tr>
<td>S</td>
<td>毫秒</td>
<td>970</td>
</tr>
<tr>
<td>E</td>
<td>周几</td>
<td>Tuesday</td>
</tr>
<tr>
<td>D</td>
<td>一年中的第几天</td>
<td>180</td>
</tr>
<tr>
<td>F</td>
<td>一个月中的第几个周几</td>
<td>2 (一个月中的第二个星期三)</td>
</tr>
<tr>
<td>w</td>
<td>一年中的第几周 r</td>
<td>27</td>
</tr>
<tr>
<td>W</td>
<td>一个月中的第几周</td>
<td>2</td>
</tr>
<tr>
<td>a</td>
<td>a.m./p.m. 指示符</td>
<td>PM</td>
</tr>
<tr>
<td>k</td>
<td>小时(12 小时制的小时)</td>
<td>24</td>
</tr>
<tr>
<td>K</td>
<td>小时(24 小时制的小时)</td>
<td>0</td>
</tr>
<tr>
<td>z</td>
<td>时区</td>
<td>中部标准时间</td>
</tr>
<tr>
<td>‘</td>
<td></td>
<td>转义文本</td>
</tr>
<tr>
<td>‘’</td>
<td></td>
<td>单引号</td>
</tr>
</tbody>
</table>
<h2 id="lt-fmt-parseDate-gt-标签"><a href="#lt-fmt-parseDate-gt-标签" class="headerlink" title="&lt;fmt:parseDate&gt; 标签"></a><code>&lt;fmt:parseDate&gt;</code> 标签</h2><p><code>&lt;fmt:parseDate&gt;</code> 标签用于解析日期。</p>
<h3 id="语法格式-3"><a href="#语法格式-3" class="headerlink" title="语法格式"></a>语法格式</h3><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;fmt:parseDate</span><br><span class="line">   value=<span class="string">"&lt;string&gt;"</span></span><br><span class="line">   type=<span class="string">"&lt;string&gt;"</span></span><br><span class="line">   dateStyle=<span class="string">"&lt;string&gt;"</span></span><br><span class="line">   timeStyle=<span class="string">"&lt;string&gt;"</span></span><br><span class="line">   pattern=<span class="string">"&lt;string&gt;"</span></span><br><span class="line">   timeZone=<span class="string">"&lt;string&gt;"</span></span><br><span class="line">   parseLocale=<span class="string">"&lt;string&gt;"</span></span><br><span class="line">   <span class="keyword">var</span>=<span class="string">"&lt;string&gt;"</span></span><br><span class="line">   scope=<span class="string">"&lt;string&gt;"</span>/&gt;</span><br></pre></td></tr></table></figure>
<h3 id="属性-3"><a href="#属性-3" class="headerlink" title="属性"></a>属性</h3><p><code>&lt;fmt:parseDate&gt;</code>标签有如下属性：</p>
<table>
<thead>
<tr>
<th>属性</th>
<th>描述</th>
<th>是否必要</th>
<th>默认值</th>
</tr>
</thead>
<tbody>
<tr>
<td>value</td>
<td>要显示的日期</td>
<td>是</td>
<td>无</td>
</tr>
<tr>
<td>type</td>
<td>DATE, TIME, 或 BOTH</td>
<td>否</td>
<td>date</td>
</tr>
<tr>
<td>dateStyle</td>
<td>FULL, LONG, MEDIUM, SHORT, 或 DEFAULT</td>
<td>否</td>
<td>default</td>
</tr>
<tr>
<td>timeStyle</td>
<td>FULL, LONG, MEDIUM, SHORT, 或 DEFAULT</td>
<td>否</td>
<td>default</td>
</tr>
<tr>
<td>pattern</td>
<td>自定义格式模式</td>
<td>否</td>
<td>无</td>
</tr>
<tr>
<td>timeZone</td>
<td>显示日期的时区</td>
<td>否</td>
<td>默认时区</td>
</tr>
<tr>
<td>var</td>
<td>存储格式化日期的变量名</td>
<td>否</td>
<td>显示在页面</td>
</tr>
<tr>
<td>scope</td>
<td>存储格式化日志变量的范围</td>
<td>否</td>
<td>页面</td>
</tr>
</tbody>
</table>
<p>属性设置我们需要的输出的时间格式。</p>
<h2 id="lt-fmt-bundle-gt-标签"><a href="#lt-fmt-bundle-gt-标签" class="headerlink" title="&lt;fmt:bundle&gt; 标签"></a><code>&lt;fmt:bundle&gt;</code> 标签</h2><p><code>&lt;fmt:bundle&gt;</code>标签将指定的资源束对出现在<code>&lt;fmt:bundle&gt;</code>标签中的<code>&lt;fmt:message&gt;</code>标签可用。这可以使您省去为每个<code>&lt;fmt:message&gt;</code>标签指定资源束的很多步骤。</p>
<p>举例来说，下面的两个<code>&lt;fmt:bundle&gt;</code>块将产生同样的输出：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;fmt:bundle basename=<span class="string">"com.tutorialspoint.Example"</span>&gt;</span><br><span class="line">    &lt;fmt:message key=<span class="string">"count.one"</span>/&gt;</span><br><span class="line">&lt;/fmt:bundle&gt;</span><br><span class="line"></span><br><span class="line">&lt;fmt:bundle basename=<span class="string">"com.tutorialspoint.Example"</span> prefix=<span class="string">"count."</span>&gt;</span><br><span class="line">    &lt;fmt:message key=<span class="string">"title"</span>/&gt;</span><br><span class="line">&lt;/fmt:bundle&gt;</span><br></pre></td></tr></table></figure>
<h3 id="语法格式-4"><a href="#语法格式-4" class="headerlink" title="语法格式"></a>语法格式</h3><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;fmt:bundle baseName=<span class="string">"&lt;string&gt;"</span> prefix=<span class="string">"&lt;string&gt;"</span>/&gt;</span><br></pre></td></tr></table></figure>
<h3 id="属性-4"><a href="#属性-4" class="headerlink" title="属性"></a>属性</h3><p><code>&lt;fmt:bundle&gt;</code>标签有如下属性：</p>
<table>
<thead>
<tr>
<th><strong>属性</strong></th>
<th><strong>描述</strong></th>
<th><strong>是否必要</strong></th>
<th><strong>默认值</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>basename</td>
<td>指定被载入的资源束的基础名称</td>
<td>是</td>
<td>无</td>
</tr>
<tr>
<td>prefix</td>
<td>指定<code>&lt;fmt:message&gt;</code>标签 key 属性的前缀</td>
<td>否</td>
<td>无</td>
</tr>
</tbody>
</table>
<h2 id="lt-fmt-setLocale-gt-标签"><a href="#lt-fmt-setLocale-gt-标签" class="headerlink" title="&lt;fmt:setLocale&gt; 标签"></a><code>&lt;fmt:setLocale&gt;</code> 标签</h2><p><code>&lt;fmt:setLocale&gt;</code>标签用来将给定的区域存储在 locale 配置变量中。</p>
<h3 id="语法格式-5"><a href="#语法格式-5" class="headerlink" title="语法格式"></a>语法格式</h3><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;fmt:setLocale value=<span class="string">"&lt;string&gt;"</span> variant=<span class="string">"&lt;string&gt;"</span> scope=<span class="string">"&lt;string&gt;"</span>/&gt;</span><br></pre></td></tr></table></figure>
<h3 id="属性-5"><a href="#属性-5" class="headerlink" title="属性"></a>属性</h3><p><code>&lt;fmt:setLocale&gt;</code>标签有如下属性：</p>
<table>
<thead>
<tr>
<th><strong>属性</strong></th>
<th><strong>描述</strong></th>
<th><strong>是否必要</strong></th>
<th><strong>默认值</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>value</td>
<td>指定 ISO-639 语言码和 ISO-3166 国家码</td>
<td>是</td>
<td>en_US</td>
</tr>
<tr>
<td>variant</td>
<td>特定浏览器变体</td>
<td>否</td>
<td>无</td>
</tr>
<tr>
<td>scope</td>
<td>Locale 配置变量的作用域</td>
<td>否</td>
<td>Page</td>
</tr>
</tbody>
</table>
<h2 id="lt-fmt-timeZone-gt-标签"><a href="#lt-fmt-timeZone-gt-标签" class="headerlink" title="&lt;fmt:timeZone&gt; 标签"></a><code>&lt;fmt:timeZone&gt;</code> 标签</h2><p><code>&lt;fmt:timeZone&gt;</code>标签用来指定时区，供其它标签使用。</p>
<h3 id="语法格式-6"><a href="#语法格式-6" class="headerlink" title="语法格式"></a>语法格式</h3><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;fmt:setLocale value=<span class="string">"&lt;string&gt;"</span> variant=<span class="string">"&lt;string&gt;"</span> scope=<span class="string">"&lt;string&gt;"</span>/&gt;</span><br></pre></td></tr></table></figure>
<h3 id="属性-6"><a href="#属性-6" class="headerlink" title="属性"></a>属性</h3><p><code>&lt;fmt:timeZone&gt;</code>标签有如下属性：</p>
<table>
<thead>
<tr>
<th><strong>属性</strong></th>
<th><strong>描述</strong></th>
<th><strong>是否必要</strong></th>
<th><strong>默认值</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>value</td>
<td>时区</td>
<td>是</td>
<td>无</td>
</tr>
</tbody>
</table>
<h2 id="lt-fmt-setTimeZone-gt-标签"><a href="#lt-fmt-setTimeZone-gt-标签" class="headerlink" title="&lt;fmt:setTimeZone&gt; 标签"></a><code>&lt;fmt:setTimeZone&gt;</code> 标签</h2><p><code>&lt;fmt:setTimeZone&gt;</code>标签用来复制一个时区对象至指定的作用域。</p>
<h3 id="语法格式-7"><a href="#语法格式-7" class="headerlink" title="语法格式"></a>语法格式</h3><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;fmt:setTimeZone value=<span class="string">"&lt;string&gt;"</span> <span class="keyword">var</span>=<span class="string">"&lt;string&gt;"</span> scope=<span class="string">"&lt;string&gt;"</span>/&gt;</span><br></pre></td></tr></table></figure>
<h3 id="属性-7"><a href="#属性-7" class="headerlink" title="属性"></a>属性</h3><p><code>&lt;fmt:setTimeZone&gt;</code>标签有如下属性：</p>
<table>
<thead>
<tr>
<th><strong>属性</strong></th>
<th><strong>描述</strong></th>
<th><strong>是否必要</strong></th>
<th><strong>默认值</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>value</td>
<td>时区</td>
<td>是</td>
<td>无</td>
</tr>
<tr>
<td>var</td>
<td>存储新时区的变量名</td>
<td>否</td>
<td>Replace default</td>
</tr>
<tr>
<td>scope</td>
<td>变量的作用域</td>
<td>否</td>
<td>Page</td>
</tr>
</tbody>
</table>
<h2 id="lt-fmt-message-gt-标签"><a href="#lt-fmt-message-gt-标签" class="headerlink" title="&lt;fmt:message&gt; 标签"></a><code>&lt;fmt:message&gt;</code> 标签</h2><p><code>&lt;fmt:message&gt;</code>标签映射一个关键字给局部消息，然后执行参数替换。</p>
<h3 id="语法格式-8"><a href="#语法格式-8" class="headerlink" title="语法格式"></a>语法格式</h3><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;fmt:message</span><br><span class="line">   key=<span class="string">"&lt;string&gt;"</span></span><br><span class="line">   bundle=<span class="string">"&lt;string&gt;"</span></span><br><span class="line">   <span class="keyword">var</span>=<span class="string">"&lt;string&gt;"</span></span><br><span class="line">   scope=<span class="string">"&lt;string&gt;"</span>/&gt;</span><br></pre></td></tr></table></figure>
<h3 id="属性-8"><a href="#属性-8" class="headerlink" title="属性"></a>属性</h3><p><code>&lt;fmt:message&gt;</code>标签有如下属性：</p>
<table>
<thead>
<tr>
<th><strong>属性</strong></th>
<th><strong>描述</strong></th>
<th><strong>是否必要</strong></th>
<th><strong>默认值</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>key</td>
<td>要检索的消息关键字</td>
<td>否</td>
<td>Body</td>
</tr>
<tr>
<td>bundle</td>
<td>要使用的资源束</td>
<td>否</td>
<td>默认资源束</td>
</tr>
<tr>
<td>var</td>
<td>存储局部消息的变量名</td>
<td>否</td>
<td>Print to page</td>
</tr>
<tr>
<td>scope</td>
<td>var 属性的作用域</td>
<td>否</td>
<td>Page</td>
</tr>
</tbody>
</table>
<h2 id="lt-fmt-requestEncoding-gt-标签"><a href="#lt-fmt-requestEncoding-gt-标签" class="headerlink" title="&lt;fmt:requestEncoding&gt; 标签"></a><code>&lt;fmt:requestEncoding&gt;</code> 标签</h2><p><code>&lt;fmt:requestEncoding&gt;</code>标签用来指定返回给 Web 应用程序的表单编码类型。</p>
<h3 id="语法格式-9"><a href="#语法格式-9" class="headerlink" title="语法格式"></a>语法格式</h3><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;fmt:requestEncoding value=<span class="string">"&lt;string&gt;"</span>/&gt;</span><br></pre></td></tr></table></figure>
<h3 id="属性-9"><a href="#属性-9" class="headerlink" title="属性"></a>属性</h3><p><code>&lt;fmt:requestEncoding&gt;</code>标签有如下属性：</p>
<table>
<thead>
<tr>
<th><strong>属性</strong></th>
<th><strong>描述</strong></th>
<th><strong>是否必要</strong></th>
<th><strong>默认值</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>key</td>
<td>字符编码集的名称，用于解码 request 参数</td>
<td>是</td>
<td>无</td>
</tr>
</tbody>
</table>
<p>使用<code>&lt;fmt:requestEncoding&gt;</code>标签来指定字符集，用于解码来自表单的数据。在字符集不是 ISO-8859-1 时必须使用这个标签。由于大多数浏览器在它们的请求中不包含 Content-Type 头，所以需要这个标签。</p>
<p><code>&lt;fmt:requestEncoding&gt;</code>标签的目的就是用来指定请求的 Content-Type。您必须指定一个 Content-Type，就算 response 是通过 Page 指令的 contentType 属性来编码。这是因为 response 的实际区域可能与 Page 指令所指定的不同。</p>
<p>如果页面包含 I18N-capable 格式行为用于设置 response 的 locale 属性（通过调用 ServletResponse.setLocale()方法），任何在页面中指定的编码集将会被覆盖。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dunwu.github.io/blog/2017/11/08/programming/java/javaweb/javaee/servlet/servlet-demo/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zhang Peng">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="张鹏的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/2017/11/08/programming/java/javaweb/javaee/servlet/servlet-demo/" itemprop="url">JavaEE Servlet 示例</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-11-08T00:00:00+08:00">
                2017-11-08
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/javaee/" itemprop="url" rel="index">
                    <span itemprop="name">javaee</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="编写-Servlet"><a href="#编写-Servlet" class="headerlink" title="编写 Servlet"></a>编写 Servlet</h2><h3 id="部署-Servlet"><a href="#部署-Servlet" class="headerlink" title="部署 Servlet"></a>部署 Servlet</h3><h3 id="web-xml-是什么"><a href="#web-xml-是什么" class="headerlink" title="web.xml 是什么"></a>web.xml 是什么</h3><h3 id="servlet-元素"><a href="#servlet-元素" class="headerlink" title="servlet 元素"></a>servlet 元素</h3><p><code>&lt;servlet&gt;</code>元素用于注册 Servlet。</p>
<p><code>&lt;servlet&gt;</code>包含有两个主要的子元素：<code>&lt;servlet-name&gt;</code>和<code>&lt;servlet-class&gt;</code>，分别用于设置 Servlet 的注册名称和 Servlet 的完整类名。</p>
<p>如果在<code>&lt;servlet&gt;</code>元素中配置了一个<code>&lt;load-on-startup&gt;</code>元素，那么 WEB 应用程序在启动时，就会装载并创建 Servlet 的实例对象、以及调用 Servlet 实例对象的 init()方法。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HelloServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.zp.notes.javaee.servlet.HelloServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="servlet-mapping-元素"><a href="#servlet-mapping-元素" class="headerlink" title="servlet-mapping 元素"></a>servlet-mapping 元素</h3><p><code>&lt;servlet-mapping&gt;</code>元素用于映射一个已注册的 Servlet 的一个对外访问路径。</p>
<p><code>&lt;servlet-mapping&gt;</code>包含有两个子元素：<code>&lt;servlet-name&gt;</code>和<code>&lt;url-pattern&gt;</code>，分别用于指定 Servlet 的注册名称和 Servlet 的对外访问路径。</p>
<p><strong>注：同一个 Servlet 可以被映射到多个 URL 上。</strong>例：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HelloServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.zp.notes.javaee.servlet.HelloServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HelloServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/servlet/HelloServlet<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/servlet/HelloServlet.asp<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/servlet/HelloServlet.jsp<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/servlet/HelloServlet.php<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/servlet/HelloServlet.aspx<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="url-pattern-的通配符"><a href="#url-pattern-的通配符" class="headerlink" title="url-pattern 的通配符"></a>url-pattern 的通配符</h3><p><code>/</code></p>
<p>如果某个 Servlet 的映射路径仅仅为一个正斜杠<code>/</code>，那么这个 Servlet 就成为当前 Web 应用程序的缺省 Servlet。  凡是在<code>web.xml</code>文件中找不到匹配的<code>&lt;servlet-mapping&gt;</code>元素的 URL，它们的访问请求都将交给缺省 Servlet 处理，也就是说，缺省 Servlet 用于处理所有其他 Servlet 都不处理的访问请求。</p>
<p><code>*</code></p>
<p><code>*</code>可以匹配任意的字符。</p>
<h3 id="init-param-元素和-context-param-元素"><a href="#init-param-元素和-context-param-元素" class="headerlink" title="init-param 元素和 context-param 元素"></a>init-param 元素和 context-param 元素</h3><p><code>&lt;init-param&gt;</code>标签用于为当前 servlet 配置一些初始化参数。</p>
<p><code>&lt;context-param&gt;</code>标签用于配置全局的初始化参数，所有 servlet 都可以使用。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">version</span>=<span class="string">"3.0"</span> <span class="attr">xmlns</span>=<span class="string">"http://java.sun.com/xml/ns/javaee"</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://java.sun.com/xml/ns/javaee</span></span></span><br><span class="line"><span class="tag"><span class="string">    http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">display-name</span>&gt;</span><span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 配置WEB应用的初始化参数 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>datasource<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>jdbc:mysql://localhost:3306/test<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">welcome-file-list</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">welcome-file</span>&gt;</span>index.jsp<span class="tag">&lt;/<span class="name">welcome-file</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">welcome-file-list</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dunwu.github.io/blog/2017/11/08/programming/java/javaweb/tools/jetty/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zhang Peng">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="张鹏的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/2017/11/08/programming/java/javaweb/tools/jetty/" itemprop="url">Jetty 使用小结</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-11-08T00:00:00+08:00">
                2017-11-08
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/javatool/" itemprop="url" rel="index">
                    <span itemprop="name">javatool</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Jetty-使用小结"><a href="#Jetty-使用小结" class="headerlink" title="Jetty 使用小结"></a>Jetty 使用小结</h1><!-- TOC depthFrom:2 depthTo:3 -->
<ul>
<li><a href="#概述">概述</a></li>
<li><a href="#jetty-的嵌入式启动">jetty 的嵌入式启动</a><ul>
<li><a href="#api-方式">API 方式</a></li>
<li><a href="#maven-插件方式">Maven 插件方式</a></li>
</ul>
</li>
<li><a href="#参考">参考</a></li>
</ul>
<!-- /TOC -->
<h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p><strong>jetty 是什么？</strong></p>
<p>jetty 是轻量级的 web 服务器和 servlet 引擎。</p>
<p>它的最大特点是：可以很方便的作为<strong>嵌入式服务器</strong>。</p>
<p>它是 eclipse 的一个开源项目。不用怀疑，就是你常用的那个 eclipse。</p>
<p>它是使用 Java 开发的，所以天然对 Java 支持良好。</p>
<p><a href="http://www.eclipse.org/jetty/index.html" target="_blank" rel="noopener">官方网址</a></p>
<p><a href="https://github.com/eclipse/jetty.project" target="_blank" rel="noopener">github 源码地址</a></p>
<p><strong>什么是嵌入式服务器？</strong></p>
<p>以 jetty 来说明，就是只要引入 jetty 的 jar 包，可以通过直接调用其 API 的方式来启动 web 服务。</p>
<p>用过 Tomcat、Resin 等服务器的朋友想必不会陌生那一套安装、配置、部署的流程吧，还是挺繁琐的。使用 jetty，就不需要这些过程了。</p>
<p>jetty 非常适用于项目的开发、测试，因为非常快捷。如果想用于生产环境，则需要谨慎考虑，它不一定能像成熟的 Tomcat、Resin 等服务器一样支持企业级 Java EE 的需要。</p>
<h2 id="jetty-的嵌入式启动"><a href="#jetty-的嵌入式启动" class="headerlink" title="jetty 的嵌入式启动"></a>jetty 的嵌入式启动</h2><p>我觉得嵌入式启动方式的一个好处在于：可以直接运行项目，无需每次部署都得再配置服务器。</p>
<p>jetty 的嵌入式启动使用有两种方式：</p>
<p>API 方式</p>
<p>maven 插件方式</p>
<h3 id="API-方式"><a href="#API-方式" class="headerlink" title="API 方式"></a>API 方式</h3><p>添加 maven 依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.eclipse.jetty<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jetty-webapp<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>9.3.2.v20150730<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.eclipse.jetty<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jetty-annotations<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>9.3.2.v20150730<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.eclipse.jetty<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>apache-jsp<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>9.3.2.v20150730<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.eclipse.jetty<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>apache-jstl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>9.3.2.v20150730<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>官方的启动代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SplitFileServer</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">( String[] args )</span> <span class="keyword">throws</span> Exception</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// 创建Server对象，并绑定端口</span></span><br><span class="line">        Server server = <span class="keyword">new</span> Server();</span><br><span class="line">        ServerConnector connector = <span class="keyword">new</span> ServerConnector(server);</span><br><span class="line">        connector.setPort(<span class="number">8090</span>);</span><br><span class="line">        server.setConnectors(<span class="keyword">new</span> Connector[] &#123; connector &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 创建上下文句柄，绑定上下文路径。这样启动后的url就会是:http://host:port/context</span></span><br><span class="line">        ResourceHandler rh0 = <span class="keyword">new</span> ResourceHandler();</span><br><span class="line">        ContextHandler context0 = <span class="keyword">new</span> ContextHandler();</span><br><span class="line">        context0.setContextPath(<span class="string">"/"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 绑定测试资源目录（在本例的配置目录dir0的路径是src/test/resources/dir0）</span></span><br><span class="line">        File dir0 = MavenTestingUtils.getTestResourceDir(<span class="string">"dir0"</span>);</span><br><span class="line">        context0.setBaseResource(Resource.newResource(dir0));</span><br><span class="line">        context0.setHandler(rh0);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 和上面的例子一样</span></span><br><span class="line">        ResourceHandler rh1 = <span class="keyword">new</span> ResourceHandler();</span><br><span class="line">        ContextHandler context1 = <span class="keyword">new</span> ContextHandler();</span><br><span class="line">        context1.setContextPath(<span class="string">"/"</span>);</span><br><span class="line">        File dir1 = MavenTestingUtils.getTestResourceDir(<span class="string">"dir1"</span>);</span><br><span class="line">        context1.setBaseResource(Resource.newResource(dir1));</span><br><span class="line">        context1.setHandler(rh1);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 绑定两个资源句柄</span></span><br><span class="line">        ContextHandlerCollection contexts = <span class="keyword">new</span> ContextHandlerCollection();</span><br><span class="line">        contexts.setHandlers(<span class="keyword">new</span> Handler[] &#123; context0, context1 &#125;);</span><br><span class="line">        server.setHandler(contexts);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 启动</span></span><br><span class="line">        server.start();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 打印dump时的信息</span></span><br><span class="line">        System.out.println(server.dump());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// join当前线程</span></span><br><span class="line">        server.join();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>直接运行 Main 方法，就可以启动 web 服务。</p>
<p><strong><em>注：以上代码在 eclipse 中运行没有问题，如果想在 Intellij 中运行还需要为它指定配置文件。</em></strong></p>
<p>如果想了解在 Eclipse 和 Intellij 都能运行的通用方法可以参考我的 github 代码示例。</p>
<p>我的实现也是参考 springside 的方式。</p>
<p>代码行数有点多，不在这里贴代码了。</p>
<p><a href="https://github.com/dunwu/spring-notes" target="_blank" rel="noopener">完整参考代码</a></p>
<h3 id="Maven-插件方式"><a href="#Maven-插件方式" class="headerlink" title="Maven 插件方式"></a>Maven 插件方式</h3><p>如果你熟悉 maven，那么实在太简单了</p>
<p><strong><em>注： Maven 版本必须在 3.3 及以上版本。</em></strong></p>
<p>(1) 添加 maven 插件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.eclipse.jetty<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jetty-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>9.3.12.v20160915<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>(2) 执行 maven 命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn jetty:run</span><br></pre></td></tr></table></figure>
<p>讲真，就是这么简单。jetty 默认会为你创建一个 web 服务，地址为 127.0.0.1:8080。</p>
<p>当然，你也可以在插件中配置你的 webapp 环境</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.eclipse.jetty<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jetty-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>9.3.12.v20160915<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">webAppSourceDirectory</span>&gt;</span>$&#123;project.basedir&#125;/src/staticfiles<span class="tag">&lt;/<span class="name">webAppSourceDirectory</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 配置webapp --&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">webApp</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">contextPath</span>&gt;</span>/<span class="tag">&lt;/<span class="name">contextPath</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">descriptor</span>&gt;</span>$&#123;project.basedir&#125;/src/over/here/web.xml<span class="tag">&lt;/<span class="name">descriptor</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">jettyEnvXml</span>&gt;</span>$&#123;project.basedir&#125;/src/over/here/jetty-env.xml<span class="tag">&lt;/<span class="name">jettyEnvXml</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">webApp</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 配置classes --&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">classesDirectory</span>&gt;</span>$&#123;project.basedir&#125;/somewhere/else<span class="tag">&lt;/<span class="name">classesDirectory</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">scanClassesPattern</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">excludes</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">exclude</span>&gt;</span>**/Foo.class<span class="tag">&lt;/<span class="name">exclude</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">excludes</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">scanClassesPattern</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">scanTargets</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">scanTarget</span>&gt;</span>src/mydir<span class="tag">&lt;/<span class="name">scanTarget</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">scanTarget</span>&gt;</span>src/myfile.txt<span class="tag">&lt;/<span class="name">scanTarget</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">scanTargets</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 扫描target目录下的资源文件 --&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">scanTargetPatterns</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">scanTargetPattern</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/other-resources<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.properties<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">excludes</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">exclude</span>&gt;</span>**/myspecial.xml<span class="tag">&lt;/<span class="name">exclude</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">exclude</span>&gt;</span>**/myspecial.properties<span class="tag">&lt;/<span class="name">exclude</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">excludes</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">scanTargetPattern</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">scanTargetPatterns</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>官方给的 jetty-env.xml 范例</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE Configure PUBLIC "-//Mort Bay Consulting//DTD Configure//EN" "http://jetty.mortbay.org/configure.dtd"&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">Configure</span> <span class="attr">class</span>=<span class="string">"org.eclipse.jetty.webapp.WebAppContext"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- Add an EnvEntry only valid for this webapp               --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">New</span> <span class="attr">id</span>=<span class="string">"gargle"</span>  <span class="attr">class</span>=<span class="string">"org.eclipse.jetty.plus.jndi.EnvEntry"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Arg</span>&gt;</span>gargle<span class="tag">&lt;/<span class="name">Arg</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Arg</span> <span class="attr">type</span>=<span class="string">"java.lang.Double"</span>&gt;</span>100<span class="tag">&lt;/<span class="name">Arg</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Arg</span> <span class="attr">type</span>=<span class="string">"boolean"</span>&gt;</span>true<span class="tag">&lt;/<span class="name">Arg</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">New</span>&gt;</span></span><br><span class="line"></span><br><span class="line"> <span class="comment">&lt;!-- Add an override for a global EnvEntry                           --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">New</span> <span class="attr">id</span>=<span class="string">"wiggle"</span>  <span class="attr">class</span>=<span class="string">"org.eclipse.jetty.plus.jndi.EnvEntry"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Arg</span>&gt;</span>wiggle<span class="tag">&lt;/<span class="name">Arg</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Arg</span> <span class="attr">type</span>=<span class="string">"java.lang.Double"</span>&gt;</span>55.0<span class="tag">&lt;/<span class="name">Arg</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Arg</span> <span class="attr">type</span>=<span class="string">"boolean"</span>&gt;</span>true<span class="tag">&lt;/<span class="name">Arg</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">New</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- an XADataSource                                                --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">New</span> <span class="attr">id</span>=<span class="string">"mydatasource99"</span> <span class="attr">class</span>=<span class="string">"org.eclipse.jetty.plus.jndi.Resource"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Arg</span>&gt;</span>jdbc/mydatasource99<span class="tag">&lt;/<span class="name">Arg</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Arg</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">New</span> <span class="attr">class</span>=<span class="string">"com.atomikos.jdbc.SimpleDataSourceBean"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Set</span> <span class="attr">name</span>=<span class="string">"xaDataSourceClassName"</span>&gt;</span>org.apache.derby.jdbc.EmbeddedXADataSource<span class="tag">&lt;/<span class="name">Set</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Set</span> <span class="attr">name</span>=<span class="string">"xaDataSourceProperties"</span>&gt;</span>databaseName=testdb99;createDatabase=create<span class="tag">&lt;/<span class="name">Set</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Set</span> <span class="attr">name</span>=<span class="string">"UniqueResourceName"</span>&gt;</span>mydatasource99<span class="tag">&lt;/<span class="name">Set</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">New</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Arg</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">New</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">Configure</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li><a href="http://wiki.eclipse.org/Jetty/Reference/jetty-env.xml" target="_blank" rel="noopener">jetty wiki</a></li>
<li><a href="http://www.eclipse.org/jetty/documentation/current/" target="_blank" rel="noopener">jetty 官方文档</a></li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dunwu.github.io/blog/2017/11/08/programming/java/javacore/appendix/jdk8-upgrade/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zhang Peng">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="张鹏的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/2017/11/08/programming/java/javacore/appendix/jdk8-upgrade/" itemprop="url">JDK8 升级常见问题</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-11-08T00:00:00+08:00">
                2017-11-08
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/javacore/" itemprop="url" rel="index">
                    <span itemprop="name">javacore</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="JDK8-升级常见问题"><a href="#JDK8-升级常见问题" class="headerlink" title="JDK8 升级常见问题"></a>JDK8 升级常见问题</h1><blockquote>
<p>JDK8 发布很久了，它提供了许多吸引人的新特性，能够提高编程效率。</p>
<p>如果是新的项目，使用 JDK8 当然是最好的选择。但是，对于一些老的项目，升级到 JDK8 则存在一些兼容性问题，是否升级需要酌情考虑。</p>
<p>近期，我在工作中遇到一个任务，将部门所有项目的 JDK 版本升级到 1.8 （老版本大多是 1.6）。在这个过程中，遇到一些问题点，并结合在网上看到的坑，在这里总结一下。</p>
</blockquote>
<h2 id="FAQ"><a href="#FAQ" class="headerlink" title="FAQ"></a>FAQ</h2><h3 id="Intellij-中的-JDK-环境设置"><a href="#Intellij-中的-JDK-环境设置" class="headerlink" title="Intellij 中的 JDK 环境设置"></a>Intellij 中的 JDK 环境设置</h3><h4 id="Settings"><a href="#Settings" class="headerlink" title="Settings"></a>Settings</h4><p>点击 <strong>File &gt; Settings &gt; Java Compiler</strong></p>
<p>Project bytecode version 选择 1.8</p>
<p>点击 <strong>File &gt; Settings &gt; Build Tools &gt; Maven &gt; Importing</strong></p>
<p>选择 JDK for importer 为 1.8</p>
<h4 id="Projcet-Settings"><a href="#Projcet-Settings" class="headerlink" title="Projcet Settings"></a>Projcet Settings</h4><p><strong>Project SDK</strong> 选择 1.8</p>
<h4 id="Application"><a href="#Application" class="headerlink" title="Application"></a>Application</h4><p>如果 web 应用的启动方式为 Application ，需要修改 JRE</p>
<p>点击 <strong>Run/Debug Configurations &gt; Configuration</strong></p>
<p>选择 JRE 为 1.8</p>
<h3 id="Linux-环境修改"><a href="#Linux-环境修改" class="headerlink" title="Linux 环境修改"></a>Linux 环境修改</h3><h4 id="修改环境变量"><a href="#修改环境变量" class="headerlink" title="修改环境变量"></a>修改环境变量</h4><p>修改 <code>/etc/profile</code> 中的 <strong>JAVA_HOME</strong>，设置 为 jdk8 所在路径。</p>
<p>修改后，执行 <code>source /etc/profile</code> 生效。</p>
<p>编译、发布脚本中如果有 <code>export JAVA_HOME</code> ，需要注意，需要使用 jdk8 的路径。</p>
<h4 id="修改-maven"><a href="#修改-maven" class="headerlink" title="修改 maven"></a>修改 maven</h4><p>settings.xml 中 profile 的激活条件如果是 jdk，需要修改一下 jdk 版本</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">activation</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">jdk</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">jdk</span>&gt;</span> <span class="comment">&lt;!-- 修改为 1.8 --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">activation</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="修改-server"><a href="#修改-server" class="headerlink" title="修改 server"></a>修改 server</h4><p>修改 server 中的 javac 版本，以 resin 为例：</p>
<p>修改 resin 配置文件中的 javac 参数。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">javac</span> <span class="attr">compiler</span>=<span class="string">"internal"</span> <span class="attr">args</span>=<span class="string">"-source 1.8"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="sun-包缺失问题"><a href="#sun-包缺失问题" class="headerlink" title="sun.* 包缺失问题"></a>sun.* 包缺失问题</h3><p>JDK8 不再提供 <code>sun.*</code> 包供开发者使用，因为这些接口不是公共接口，不能保证在所有 Java 兼容的平台上工作。</p>
<p>使用了这些 API 的程序如果要升级到 JDK 1.8 需要寻求替代方案。</p>
<p>虽然，也可以自己导入包含 <code>sun.*</code> 接口 jar 包到 classpath 目录，但这不是一个好的做法。</p>
<p>需要详细了解为什么不要使用 <code>sun.*</code> ，可以参考官方文档：<a href="http://www.oracle.com/technetwork/java/faq-sun-packages-142232.html" target="_blank" rel="noopener">Why Developers Should Not Write Programs That Call ‘sun’ Packages</a></p>
<h3 id="默认安全策略修改"><a href="#默认安全策略修改" class="headerlink" title="默认安全策略修改"></a>默认安全策略修改</h3><p>升级后估计有些小伙伴在使用不安全算法时可能会发生错误，so，支持不安全算法还是有必要的</p>
<p>找到$JAVA_HOME下 <code>jre/lib/security/java.security</code> ，将禁用的算法设置为空：<code>jdk.certpath.disabledAlgorithms=</code> 。</p>
<h3 id="JVM参数调整"><a href="#JVM参数调整" class="headerlink" title="JVM参数调整"></a>JVM参数调整</h3><p>在jdk8中，PermSize相关的参数已经不被使用：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-XX:MaxPermSize=size</span><br><span class="line"></span><br><span class="line">Sets the maximum permanent generation space size (in bytes). This option was deprecated in JDK 8, and superseded by the -XX:MaxMetaspaceSize option.</span><br><span class="line"></span><br><span class="line">-XX:PermSize=size</span><br><span class="line"></span><br><span class="line">Sets the space (in bytes) allocated to the permanent generation that triggers a garbage collection if it is exceeded. This option was deprecated un JDK 8, and superseded by the -XX:MetaspaceSize option.</span><br></pre></td></tr></table></figure>
<p>JDK8 中再也没有 <code>PermGen</code> 了。其中的某些部分，如被 intern 的字符串，在 JDK7 中已经移到了普通堆里。<strong>其余结构在 JDK8 中会被移到称作“Metaspace”的本机内存区中，该区域在默认情况下会自动生长，也会被垃圾回收。它有两个标记：MetaspaceSize 和 MaxMetaspaceSize。</strong></p>
<p>-XX:MetaspaceSize=size</p>
<blockquote>
<p>Sets the size of the allocated class metadata space that will trigger a garbage collection the first time it is exceeded. This threshold for a garbage collection is increased or decreased depending on the amount of metadata used. The default size depends on the platform.</p>
</blockquote>
<p>-XX:MaxMetaspaceSize=size</p>
<blockquote>
<p> Sets the maximum amount of native memory that can be allocated for class metadata. By default, the size is not limited.  The amount of metadata for an application depends on the application itself, other running applications, and the amount of memory available on the system.</p>
</blockquote>
<p>以下示例显示如何将类类元数据的上限设置为 256 MB：</p>
<p>XX:MaxMetaspaceSize=256m</p>
<h3 id="字节码问题"><a href="#字节码问题" class="headerlink" title="字节码问题"></a>字节码问题</h3><p>ASM 5.0 beta 开始支持 JDK8</p>
<p><strong>字节码错误</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Caused by: java.io.IOException: invalid constant type: 15</span><br><span class="line">	at javassist.bytecode.ConstPool.readOne(ConstPool.java:1113)</span><br></pre></td></tr></table></figure>
<ul>
<li>查找组件用到了 mvel，mvel 为了提高效率进行了字节码优化，正好碰上 JDK8 死穴，所以需要升级。</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mvel<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mvel2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.7.Final<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>javassist</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.javassist<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javassist<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.18.1-GA<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>注意</strong></p>
<p>有些部署工具不会删除旧版本 jar 包，所以可以尝试手动删除老版本 jar 包。</p>
</blockquote>
<p><a href="http://asm.ow2.org/history.html" target="_blank" rel="noopener">http://asm.ow2.org/history.html</a></p>
<h3 id="Java连接redis启动报错Error-redis-clients-jedis-HostAndPort-cant-resolve-localhost-address"><a href="#Java连接redis启动报错Error-redis-clients-jedis-HostAndPort-cant-resolve-localhost-address" class="headerlink" title="Java连接redis启动报错Error redis clients jedis HostAndPort cant resolve localhost address"></a>Java连接redis启动报错Error redis clients jedis HostAndPort cant resolve localhost address</h3><p>错误环境:<br>本地window开发环境没有问题。上到Linux环境,启动出现问题。<br>错误信息:<br>Error redis clients jedis HostAndPort cant resolve localhost address</p>
<p>解决办法:</p>
<ol>
<li>查看Linux系统的主机名</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># hostname</span><br><span class="line">template</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>查看/etc/hosts文件中是否有127.0.0.1对应主机名，如果没有则添加</li>
</ol>
<h3 id="Resin-容器指定-JDK-1-8"><a href="#Resin-容器指定-JDK-1-8" class="headerlink" title="Resin 容器指定 JDK 1.8"></a>Resin 容器指定 JDK 1.8</h3><p>如果 resin 容器原来版本低于 JDK1.8，运行 JDK 1.8 编译的 web app 时，可能会提示错误：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java.lang.UnsupportedClassVersionError: PR/Sort : Unsupported major.minor version 52.0</span><br></pre></td></tr></table></figure>
<p>解决方法就是，使用 JDK 1.8 要重新编译一下。然后，我在部署时出现过编译后仍报错的情况，重启一下服务器后，问题解决，不知是什么原因。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">./configure --prefix=/usr/local/resin  --with-java=/usr/local/jdk1.8.0_121</span><br><span class="line">make &amp; make install</span><br></pre></td></tr></table></figure>
<h2 id="资料"><a href="#资料" class="headerlink" title="资料"></a>资料</h2><ul>
<li><a href="http://www.oracle.com/technetwork/java/javase/8-compatibility-guide-2156366.html" target="_blank" rel="noopener">Compatibility Guide for JDK 8</a></li>
<li><a href="https://yq.aliyun.com/articles/236" target="_blank" rel="noopener">Compatibility Guide for JDK 8 中文翻译</a></li>
<li><a href="http://www.oracle.com/technetwork/java/faq-sun-packages-142232.html" target="_blank" rel="noopener">Why Developers Should Not Write Programs That Call ‘sun’ Packages</a></li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dunwu.github.io/blog/2017/11/08/programming/java/spring/integration/spring-and-dubbo/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zhang Peng">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="张鹏的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/2017/11/08/programming/java/spring/integration/spring-and-dubbo/" itemprop="url">Spring 集成 Dubbo</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-11-08T00:00:00+08:00">
                2017-11-08
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/spring/" itemprop="url" rel="index">
                    <span itemprop="name">spring</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="ZooKeeper"><a href="#ZooKeeper" class="headerlink" title="ZooKeeper"></a>ZooKeeper</h2><p>ZooKeeper 可以作为 Dubbo 的注册中心。</p>
<p>Dubbo 未对 Zookeeper 服务器端做任何侵入修改，只需安装原生的 Zookeeper 服务器即可，所有注册中心逻辑适配都在调用 Zookeeper 客户端时完成。</p>
<p><strong>安装</strong></p>
<p>在 <a href="http://zookeeper.apache.org/releases.html" target="_blank" rel="noopener">ZooKeeper 发布中心</a> 选择需要的版本，下载后解压到本地。</p>
<p><strong>配置</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi conf/zoo.cfg</span><br></pre></td></tr></table></figure>
<p>如果不需要集群，<code>zoo.cfg</code> 的内容如下 <a href="https://dubbo.gitbooks.io/dubbo-admin-book/content/install/zookeeper.html#fn_2" target="_blank" rel="noopener">2</a>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">tickTime=2000</span><br><span class="line">initLimit=10</span><br><span class="line">syncLimit=5</span><br><span class="line">dataDir=/home/dubbo/zookeeper-3.3.3/data</span><br><span class="line">clientPort=2181</span><br></pre></td></tr></table></figure>
<p>如果需要集群，<code>zoo.cfg</code> 的内容如下 <a href="https://dubbo.gitbooks.io/dubbo-admin-book/content/install/zookeeper.html#fn_3" target="_blank" rel="noopener">3</a>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">tickTime=2000</span><br><span class="line">initLimit=10</span><br><span class="line">syncLimit=5</span><br><span class="line">dataDir=/home/dubbo/zookeeper-3.3.3/data</span><br><span class="line">clientPort=2181</span><br><span class="line">server.1=10.20.153.10:2555:3555</span><br><span class="line">server.2=10.20.153.11:2555:3555</span><br></pre></td></tr></table></figure>
<p>并在 data 目录 <a href="https://dubbo.gitbooks.io/dubbo-admin-book/content/install/zookeeper.html#fn_4" target="_blank" rel="noopener">4</a> 下放置 myid 文件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir data</span><br><span class="line">vi myid</span><br></pre></td></tr></table></figure>
<p>myid 指明自己的 id，对应上面 <code>zoo.cfg</code> 中 <code>server.</code> 后的数字，第一台的内容为 1，第二台的内容为 2，内容如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1</span><br></pre></td></tr></table></figure>
<p><strong>启动</strong></p>
<p>Linux 下执行 <code>bin/zkServer.sh</code> ；Windows <code>bin/zkServer.cmd</code> 启动 ZooKeeper 。</p>
<p><strong>命令行</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">telnet 127.0.0.1 2181</span><br><span class="line">dump</span><br></pre></td></tr></table></figure>
<p>或者:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo dump | nc 127.0.0.1 2181</span><br></pre></td></tr></table></figure>
<p>用法:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dubbo.registry.address=zookeeper://10.20.153.10:2181?backup=10.20.153.11:2181</span><br></pre></td></tr></table></figure>
<p>或者:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;dubbo:registry protocol=&quot;zookeeper&quot; address=&quot;10.20.153.10:2181,10.20.153.11:2181&quot; /&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<ol>
<li>Zookeeper是 Apache Hadoop 的子项目，强度相对较好，建议生产环境使用该注册中心</li>
<li>其中 data 目录需改成你真实输出目录</li>
<li>其中 data 目录和 server 地址需改成你真实部署机器的信息</li>
<li>上面 <code>zoo.cfg</code> 中的 <code>dataDir</code></li>
<li><a href="http://zookeeper.apache.org/doc/r3.3.3/zookeeperAdmin.html" target="_blank" rel="noopener">http://zookeeper.apache.org/doc/r3.3.3/zookeeperAdmin.html</a></li>
</ol>
</blockquote>
<h2 id="Dubbo"><a href="#Dubbo" class="headerlink" title="Dubbo"></a>Dubbo</h2><p>Dubbo 采用全 Spring 配置方式，透明化接入应用，对应用没有任何 API 侵入，只需用 Spring 加载 Dubbo 的配置即可，Dubbo 基于 Spring 的 Schema 扩展进行加载。</p>
<p>如果不想使用 Spring 配置，可以通过 <a href="https://dubbo.gitbooks.io/configuration/api.md" target="_blank" rel="noopener">API 的方式</a> 进行调用。</p>
<h2 id="服务提供者"><a href="#服务提供者" class="headerlink" title="服务提供者"></a>服务提供者</h2><p>完整安装步骤，请参见：<a href="https://dubbo.gitbooks.io/dubbo-admin-book/install/provider-demo.html" target="_blank" rel="noopener">示例提供者安装</a></p>
<h3 id="定义服务接口"><a href="#定义服务接口" class="headerlink" title="定义服务接口"></a>定义服务接口</h3><p>DemoService.java <a href="https://dubbo.gitbooks.io/dubbo-user-book/quick-start.html#fn_1" target="_blank" rel="noopener">1</a>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.alibaba.dubbo.demo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">DemoService</span> </span>&#123;</span><br><span class="line">    <span class="function">String <span class="title">sayHello</span><span class="params">(String name)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="在服务提供方实现接口"><a href="#在服务提供方实现接口" class="headerlink" title="在服务提供方实现接口"></a>在服务提供方实现接口</h3><p>DemoServiceImpl.java <a href="https://dubbo.gitbooks.io/dubbo-user-book/quick-start.html#fn_2" target="_blank" rel="noopener">2</a>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.alibaba.dubbo.demo.provider;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.dubbo.demo.DemoService;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DemoServiceImpl</span> <span class="keyword">implements</span> <span class="title">DemoService</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">sayHello</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Hello "</span> + name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="用-Spring-配置声明暴露服务"><a href="#用-Spring-配置声明暴露服务" class="headerlink" title="用 Spring 配置声明暴露服务"></a>用 Spring 配置声明暴露服务</h3><p>provider.xml：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:dubbo</span>=<span class="string">"http://code.alibabatech.com/schema/dubbo"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans        http://www.springframework.org/schema/beans/spring-beans.xsd        http://code.alibabatech.com/schema/dubbo        http://code.alibabatech.com/schema/dubbo/dubbo.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 提供方应用信息，用于计算依赖关系 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dubbo:application</span> <span class="attr">name</span>=<span class="string">"hello-world-app"</span>  /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 使用multicast广播注册中心暴露服务地址 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dubbo:registry</span> <span class="attr">address</span>=<span class="string">"multicast://224.5.6.7:1234"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 用dubbo协议在20880端口暴露服务 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dubbo:protocol</span> <span class="attr">name</span>=<span class="string">"dubbo"</span> <span class="attr">port</span>=<span class="string">"20880"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 声明需要暴露的服务接口 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dubbo:service</span> <span class="attr">interface</span>=<span class="string">"com.alibaba.dubbo.demo.DemoService"</span> <span class="attr">ref</span>=<span class="string">"demoService"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 和本地bean一样实现服务 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"demoService"</span> <span class="attr">class</span>=<span class="string">"com.alibaba.dubbo.demo.provider.DemoServiceImpl"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>如果注册中心使用 ZooKeeper，可以将 dubbo:registry 改为 zookeeper://127.0.0.1:2181</p>
<h3 id="加载-Spring-配置"><a href="#加载-Spring-配置" class="headerlink" title="加载 Spring 配置"></a>加载 Spring 配置</h3><p>Provider.java：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Provider</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        ClassPathXmlApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="keyword">new</span> String[] &#123;<span class="string">"http://10.20.160.198/wiki/display/dubbo/provider.xml"</span>&#125;);</span><br><span class="line">        context.start();</span><br><span class="line">        System.in.read(); <span class="comment">// 按任意键退出</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="服务消费者"><a href="#服务消费者" class="headerlink" title="服务消费者"></a>服务消费者</h2><p>完整安装步骤，请参见：<a href="https://dubbo.gitbooks.io/dubbo-admin-book/install/consumer-demo.html" target="_blank" rel="noopener">示例消费者安装</a></p>
<h3 id="通过-Spring-配置引用远程服务"><a href="#通过-Spring-配置引用远程服务" class="headerlink" title="通过 Spring 配置引用远程服务"></a>通过 Spring 配置引用远程服务</h3><p>consumer.xml：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:dubbo</span>=<span class="string">"http://code.alibabatech.com/schema/dubbo"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans        http://www.springframework.org/schema/beans/spring-beans.xsd        http://code.alibabatech.com/schema/dubbo        http://code.alibabatech.com/schema/dubbo/dubbo.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 消费方应用名，用于计算依赖关系，不是匹配条件，不要与提供方一样 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dubbo:application</span> <span class="attr">name</span>=<span class="string">"consumer-of-helloworld-app"</span>  /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 使用multicast广播注册中心暴露发现服务地址 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dubbo:registry</span> <span class="attr">address</span>=<span class="string">"multicast://224.5.6.7:1234"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 生成远程服务代理，可以和本地bean一样使用demoService --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dubbo:reference</span> <span class="attr">id</span>=<span class="string">"demoService"</span> <span class="attr">interface</span>=<span class="string">"com.alibaba.dubbo.demo.DemoService"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>如果注册中心使用 ZooKeeper，可以将 dubbo:registry 改为 zookeeper://127.0.0.1:2181</p>
<h3 id="加载Spring配置，并调用远程服务"><a href="#加载Spring配置，并调用远程服务" class="headerlink" title="加载Spring配置，并调用远程服务"></a>加载Spring配置，并调用远程服务</h3><p>Consumer.java <a href="https://dubbo.gitbooks.io/dubbo-user-book/quick-start.html#fn_3" target="_blank" rel="noopener">3</a>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line">import com.alibaba.dubbo.demo.DemoService;</span><br><span class="line"></span><br><span class="line">public class Consumer &#123;</span><br><span class="line">    public static void main(String[] args) throws Exception &#123;</span><br><span class="line">        ClassPathXmlApplicationContext context = new ClassPathXmlApplicationContext(new String[] &#123;&quot;http://10.20.160.198/wiki/display/dubbo/consumer.xml&quot;&#125;);</span><br><span class="line">        context.start();</span><br><span class="line">        DemoService demoService = (DemoService)context.getBean(&quot;demoService&quot;); // 获取远程服务代理</span><br><span class="line">        String hello = demoService.sayHello(&quot;world&quot;); // 执行远程方法</span><br><span class="line">        System.out.println( hello ); // 显示调用结果</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<ol>
<li>该接口需单独打包，在服务提供方和消费方共享</li>
<li>对服务消费方隐藏实现</li>
<li>也可以使用 IoC 注入</li>
</ol>
</blockquote>
<h2 id="FAQ"><a href="#FAQ" class="headerlink" title="FAQ"></a>FAQ</h2><p>建议使用 <code>dubbo-2.3.3</code> 以上版本的 zookeeper 注册中心客户端。</p>
<h2 id="资料"><a href="#资料" class="headerlink" title="资料"></a>资料</h2><p><strong>Dubbo</strong></p>
<p><a href="https://github.com/alibaba/dubbo" target="_blank" rel="noopener">Github</a> | <a href="https://dubbo.gitbooks.io/dubbo-user-book/content/" target="_blank" rel="noopener">用户手册</a> | <a href="https://dubbo.gitbooks.io/dubbo-dev-book/content/" target="_blank" rel="noopener">开发手册</a> | <a href="https://dubbo.gitbooks.io/dubbo-admin-book/content/" target="_blank" rel="noopener">管理员手册</a></p>
<p><strong>ZooKeeper</strong></p>
<p><a href="http://zookeeper.apache.org/" target="_blank" rel="noopener">官网</a> | <a href="http://zookeeper.apache.org/doc/trunk/" target="_blank" rel="noopener">官方文档</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dunwu.github.io/blog/2017/11/08/programming/java/javaweb/javaee/jstl/jstl-function/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zhang Peng">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="张鹏的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/2017/11/08/programming/java/javaweb/javaee/jstl/jstl-function/" itemprop="url">JSTL 函数</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-11-08T00:00:00+08:00">
                2017-11-08
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/javaee/" itemprop="url" rel="index">
                    <span itemprop="name">javaee</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>JSTL 包含一系列标准函数，大部分是通用的字符串处理函数。引用 JSTL 函数库的语法如下：</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ taglib prefix=<span class="string">"fn"</span></span><br><span class="line">           uri=<span class="string">"http://java.sun.com/jsp/jstl/functions"</span> %&gt;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>函数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://www.runoob.com/jsp/jstl-function-contains.html" target="_blank" rel="noopener">fn:contains()</a></td>
<td>测试输入的字符串是否包含指定的子串</td>
</tr>
<tr>
<td><a href="http://www.runoob.com/jsp/jstl-function-containsignoreCase.html" target="_blank" rel="noopener">fn:containsIgnoreCase()</a></td>
<td>测试输入的字符串是否包含指定的子串，大小写不敏感</td>
</tr>
<tr>
<td><a href="http://www.runoob.com/jsp/jstl-function-endswith.html" target="_blank" rel="noopener">fn:endsWith()</a></td>
<td>测试输入的字符串是否以指定的后缀结尾</td>
</tr>
<tr>
<td><a href="http://www.runoob.com/jsp/jstl-function-escapexml.html" target="_blank" rel="noopener">fn:escapeXml()</a></td>
<td>跳过可以作为 XML 标记的字符</td>
</tr>
<tr>
<td><a href="http://www.runoob.com/jsp/jstl-function-indexof.html" target="_blank" rel="noopener">fn:indexOf()</a></td>
<td>返回指定字符串在输入字符串中出现的位置</td>
</tr>
<tr>
<td><a href="http://www.runoob.com/jsp/jstl-function-join.html" target="_blank" rel="noopener">fn:join()</a></td>
<td>将数组中的元素合成一个字符串然后输出</td>
</tr>
<tr>
<td><a href="http://www.runoob.com/jsp/jstl-function-length.html" target="_blank" rel="noopener">fn:length()</a></td>
<td>返回字符串长度</td>
</tr>
<tr>
<td><a href="http://www.runoob.com/jsp/jstl-function-replace.html" target="_blank" rel="noopener">fn:replace()</a></td>
<td>将输入字符串中指定的位置替换为指定的字符串然后返回</td>
</tr>
<tr>
<td><a href="http://www.runoob.com/jsp/jstl-function-split.html" target="_blank" rel="noopener">fn:split()</a></td>
<td>将字符串用指定的分隔符分隔然后组成一个子字符串数组并返回</td>
</tr>
<tr>
<td><a href="http://www.runoob.com/jsp/jstl-function-startswith.html" target="_blank" rel="noopener">fn:startsWith()</a></td>
<td>测试输入字符串是否以指定的前缀开始</td>
</tr>
<tr>
<td><a href="http://www.runoob.com/jsp/jstl-function-substring.html" target="_blank" rel="noopener">fn:substring()</a></td>
<td>返回字符串的子集</td>
</tr>
<tr>
<td><a href="http://www.runoob.com/jsp/jstl-function-substringafter.html" target="_blank" rel="noopener">fn:substringAfter()</a></td>
<td>返回字符串在指定子串之后的子集</td>
</tr>
<tr>
<td><a href="http://www.runoob.com/jsp/jstl-function-substringbefore.html" target="_blank" rel="noopener">fn:substringBefore()</a></td>
<td>返回字符串在指定子串之前的子集</td>
</tr>
<tr>
<td><a href="http://www.runoob.com/jsp/jstl-function-tolowercase.html" target="_blank" rel="noopener">fn:toLowerCase()</a></td>
<td>将字符串中的字符转为小写</td>
</tr>
<tr>
<td><a href="http://www.runoob.com/jsp/jstl-function-touppercase.html" target="_blank" rel="noopener">fn:toUpperCase()</a></td>
<td>将字符串中的字符转为大写</td>
</tr>
<tr>
<td><a href="http://www.runoob.com/jsp/jstl-function-trim.html" target="_blank" rel="noopener">fn:trim()</a></td>
<td>移除首位的空白符</td>
</tr>
</tbody>
</table>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dunwu.github.io/blog/2017/11/08/programming/java/javaweb/javaee/listener/listener/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zhang Peng">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="张鹏的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/2017/11/08/programming/java/javaweb/javaee/listener/listener/" itemprop="url">JavaEE 监听器</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-11-08T00:00:00+08:00">
                2017-11-08
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/javaee/" itemprop="url" rel="index">
                    <span itemprop="name">javaee</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>监听器是一个专门用于对其他对象身上发生的事件或状态改变进行监听和相应处理的对象，当被监视的对象发生情况时，立即采取相应的行动。监听器其实就是一个实现特定接口的普通 java 程序，这个程序专门用于监听另一个 java 对象的方法调用或属性改变，当被监听对象发生上述事件后，监听器某个方法立即被执行。</p>
<h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>JavaWeb 中的监听器是 Servlet 规范中定义的一种特殊类，它用于监听 web 应用程序中的<code>ServletContext</code>, <code>HttpSession</code>和 <code>ServletRequest</code>等域对象的创建与销毁事件，以及监听这些域对象中的属性发生修改的事件。</p>
<h2 id="监听器的分类"><a href="#监听器的分类" class="headerlink" title="监听器的分类"></a>监听器的分类</h2><p>在 Servlet 规范中定义了多种类型的监听器，它们用于监听的事件源分别为<code>ServletContext</code>，<code>HttpSession</code>和<code>ServletRequest</code>这三个域对象<br>Servlet 规范针对这三个对象上的操作，又把多种类型的监听器划分为三种类型：</p>
<ol>
<li>监听域对象自身的创建和销毁的事件监听器。</li>
<li>监听域对象中的属性的增加和删除的事件监听器。</li>
<li>监听绑定到 HttpSession 域中的某个对象的状态的事件监听器。</li>
</ol>
<h3 id="监听对象的创建和销毁"><a href="#监听对象的创建和销毁" class="headerlink" title="监听对象的创建和销毁"></a>监听对象的创建和销毁</h3><h4 id="HttpSessionListener"><a href="#HttpSessionListener" class="headerlink" title="HttpSessionListener"></a>HttpSessionListener</h4><p><code>HttpSessionListener</code> 接口用于监听<code>HttpSession</code>对象的创建和销毁</p>
<p>创建一个<code>Session</code>时，激发<code>sessionCreated (HttpSessionEvent se)</code> 方法</p>
<p>销毁一个<code>Session</code>时，激发<code>sessionDestroyed (HttpSessionEvent se)</code> 方法。</p>
<h4 id="ServletContextListener"><a href="#ServletContextListener" class="headerlink" title="ServletContextListener"></a>ServletContextListener</h4><p><code>ServletContextListener</code>接口用于监听<code>ServletContext</code>对象的创建和销毁事件。</p>
<p>实现了<code>ServletContextListener</code>接口的类都可以对<code>ServletContext</code>对象的创建和销毁进行监听。</p>
<p>当<code>ServletContext</code>对象被创建时，激发<code>contextInitialized (ServletContextEvent sce)</code>方法。</p>
<p>当<code>ServletContext</code>对象被销毁时，激发<code>contextDestroyed(ServletContextEvent sce)</code>方法。</p>
<p><code>ServletContext</code>域对象创建和销毁时机：</p>
<ul>
<li>创建：服务器启动针对每一个 Web 应用创建<code>ServletContext</code></li>
<li>销毁：服务器关闭前先关闭代表每一个 web 应用的<code>ServletContext</code></li>
</ul>
<h4 id="ServletRequestListener"><a href="#ServletRequestListener" class="headerlink" title="ServletRequestListener"></a>ServletRequestListener</h4><p><code>ServletRequestListener</code>接口用于监听<code>ServletRequest</code> 对象的创建和销毁</p>
<p><code>Request</code>对象被创建时，监听器的<code>requestInitialized(ServletRequestEvent sre)</code>方法将会被调用</p>
<p><code>Request</code>对象被销毁时，监听器的<code>requestDestroyed(ServletRequestEvent sre)</code>方法将会被调用</p>
<p><code>ServletRequest</code>域对象创建和销毁时机：</p>
<p>创建：用户每一次访问都会创建 request 对象</p>
<p>销毁：当前访问结束，request 对象就会销毁</p>
<h3 id="监听对象的属性变化"><a href="#监听对象的属性变化" class="headerlink" title="监听对象的属性变化"></a>监听对象的属性变化</h3><p>域对象中属性的变更的事件监听器就是用来监听 ServletContext, HttpSession, HttpServletRequest 这三个对象中的属性变更信息事件的监听器。<br>这三个监听器接口分别是 ServletContextAttributeListener, HttpSessionAttributeListener 和 ServletRequestAttributeListener，这三个接口中都定义了三个方法来处理被监听对象中的属性的增加，删除和替换的事件，同一个事件在这三个接口中对应的方法名称完全相同，只是接受的参数类型不同。</p>
<h4 id="attributeAdded-方法"><a href="#attributeAdded-方法" class="headerlink" title="attributeAdded 方法"></a>attributeAdded 方法</h4><p>当向被监听对象中增加一个属性时，web 容器就调用事件监听器的<code>attributeAdded</code>方法进行响应，这个方法接收一个事件类型的参数，监听器可以通过这个参数来获得正在增加属性的域对象和被保存到域中的属性对象<br>各个域属性监听器中的完整语法定义为：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">attributeAdded</span><span class="params">(ServletContextAttributeEvent scae)</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">attributeReplaced</span><span class="params">(HttpSessionBindingEvent  hsbe)</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">attributeRmoved</span><span class="params">(ServletRequestAttributeEvent srae)</span></span></span><br></pre></td></tr></table></figure>
<h4 id="attributeRemoved-方法"><a href="#attributeRemoved-方法" class="headerlink" title="attributeRemoved 方法"></a>attributeRemoved 方法</h4><p>当删除被监听对象中的一个属性时，web 容器调用事件监听器的<code>attributeRemoved</code>方法进行响应<br>各个域属性监听器中的完整语法定义为：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">attributeRemoved</span><span class="params">(ServletContextAttributeEvent scae)</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">attributeRemoved</span> <span class="params">(HttpSessionBindingEvent  hsbe)</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">attributeRemoved</span> <span class="params">(ServletRequestAttributeEvent srae)</span></span></span><br></pre></td></tr></table></figure>
<h4 id="attributeReplaced-方法"><a href="#attributeReplaced-方法" class="headerlink" title="attributeReplaced 方法"></a>attributeReplaced 方法</h4><p>当监听器的域对象中的某个属性被替换时，web 容器调用事件监听器的<code>attributeReplaced</code>方法进行响应<br>各个域属性监听器中的完整语法定义为：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">attributeReplaced</span><span class="params">(ServletContextAttributeEvent scae)</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">attributeReplaced</span> <span class="params">(HttpSessionBindingEvent  hsbe)</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">attributeReplaced</span> <span class="params">(ServletRequestAttributeEvent srae)</span></span></span><br></pre></td></tr></table></figure>
<h3 id="监听-Session-内的对象"><a href="#监听-Session-内的对象" class="headerlink" title="监听 Session 内的对象"></a>监听 Session 内的对象</h3><p>保存在 Session 域中的对象可以有多种状态：</p>
<ul>
<li>绑定(session.setAttribute(“bean”,Object))到 Session 中；</li>
<li>从 Session 域中解除(session.removeAttribute(“bean”))绑定；</li>
<li>随 Session 对象持久化到一个存储设备中；</li>
<li>随 Session 对象从一个存储设备中恢复</li>
</ul>
<p>Servlet 规范中定义了两个特殊的监听器接口<code>HttpSessionBindingListener</code>和<code>HttpSessionActivationListener</code>来帮助 JavaBean 对象了解自己在 Session 域中的这些状态。</p>
<p>实现这两个接口的类不需要 web.xml 文件中进行注册。</p>
<h4 id="HttpSessionBindingListener"><a href="#HttpSessionBindingListener" class="headerlink" title="HttpSessionBindingListener"></a>HttpSessionBindingListener</h4><p>实现了<code>HttpSessionBindingListener</code>接口的 JavaBean 对象可以感知自己被绑定到 Session 中和 Session 中删除的事件。</p>
<ul>
<li><p>当对象被绑定到<code>HttpSession</code>对象中时，web 服务器调用该对象的<code>valueBound(HttpSessionBindingEvent event)</code>方法。</p>
</li>
<li><p>当对象从<code>HttpSession</code>对象中解除绑定时，web 服务器调用该对象的<code>valueUnbound(HttpSessionBindingEvent event)</code>方法。</p>
</li>
</ul>
<h4 id="HttpSessionActivationListener"><a href="#HttpSessionActivationListener" class="headerlink" title="HttpSessionActivationListener"></a>HttpSessionActivationListener</h4><p>实现了<code>HttpSessionActivationListener</code>接口的 JavaBean 对象可以感知自己被活化(反序列化)和钝化(序列化)的事件。</p>
<p>当绑定到 HttpSession 对象中的 javabean 对象将要随 HttpSession 对象被钝化(序列化)之前，web 服务器调用该 javabean 对象的<code>sessionWillPassivate(HttpSessionEvent event)</code> 方法。这样 javabean 对象就可以知道自己将要和 HttpSession 对象一起被序列化(钝化)到硬盘中.</p>
<p>当绑定到 HttpSession 对象中的 javabean 对象将要随 HttpSession 对象被活化(反序列化)之后，web 服务器调用该 javabean 对象的<code>sessionDidActive(HttpSessionEvent event)</code>方法。这样 javabean 对象就可以知道自己将要和 HttpSession 对象一起被反序列化(活化)回到内存中</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dunwu.github.io/blog/2017/11/08/programming/java/javaweb/javaee/jsp/jsp-locale/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zhang Peng">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="张鹏的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/2017/11/08/programming/java/javaweb/javaee/jsp/jsp-locale/" itemprop="url">JSP 国际化</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-11-08T00:00:00+08:00">
                2017-11-08
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/javaee/" itemprop="url" rel="index">
                    <span itemprop="name">javaee</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>在开始前，需要解释几个重要的概念：</p>
<ul>
<li>国际化（i18n）：表明一个页面根据访问者的语言或国家来呈现不同的翻译版本。</li>
<li>本地化（l10n）：向网站添加资源，以使它适应不同的地区和文化。比如网站的印度语版本。</li>
<li>区域：这是一个特定的区域或文化，通常认为是一个语言标志和国家标志通过下划线连接起来。比如”en_US”代表美国英语地区。</li>
</ul>
<p>如果想要建立一个全球化的网站，就需要关心一系列项目。本章将会详细告诉您如何处理国际化问题，并给出了一些例子来加深理解。</p>
<p>JSP 容器能够根据 request 的 locale 属性来提供正确地页面版本。接下来给出了如何通过 request 对象来获得 Locale 对象的语法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java.util.Locale request.getLocale()</span><br></pre></td></tr></table></figure>
<h2 id="检测-Locale"><a href="#检测-Locale" class="headerlink" title="检测 Locale"></a>检测 Locale</h2><p>下表列举出了 Locale 对象中比较重要的方法，用于检测 request 对象的地区，语言，和区域。所有这些方法都会在浏览器中显示国家名称和语言名称：</p>
<table>
<thead>
<tr>
<th><strong>序号</strong></th>
<th><strong>方法</strong> &amp; <strong>描述</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td><strong>String getCountry()</strong>返回国家/地区码的英文大写，或 ISO 3166 2-letter 格式的区域</td>
</tr>
<tr>
<td>2</td>
<td><strong>String getDisplayCountry()</strong>返回要显示给用户的国家名称</td>
</tr>
<tr>
<td>3</td>
<td><strong>String getLanguage()</strong>返回语言码的英文小写，或 ISO 639 格式的区域</td>
</tr>
<tr>
<td>4</td>
<td><strong>String getDisplayLanguage()</strong>返回要给用户看的语言名称</td>
</tr>
<tr>
<td>5</td>
<td><strong>String getISO3Country()</strong>返回国家名称的 3 字母缩写</td>
</tr>
<tr>
<td>6</td>
<td><strong>String getISO3Language()</strong>返回语言名称的 3 字母缩写</td>
</tr>
</tbody>
</table>
<h2 id="语言设置"><a href="#语言设置" class="headerlink" title="语言设置"></a>语言设置</h2><p>JSP 可以使用西欧语言来输出一个页面，比如英语，西班牙语，德语，法语，意大利语等等。由此可见，设置<code>Content-Language</code>信息头来正确显示所有字符是很重要的。</p>
<p>第二点就是，需要使用 HTML 字符实体来显示特殊字符，比如”ñ” 代表的是”?”，”¡”代表的是 “?” ：</p>
<h2 id="区域特定日期"><a href="#区域特定日期" class="headerlink" title="区域特定日期"></a>区域特定日期</h2><p>可以使用<code>java.text.DateFormat</code>类和它的静态方法<code>getDateTimeInstance()</code>来格式化日期和时间。接下来的这个例子显示了如何根据指定的区域来格式化日期和时间：</p>
<h2 id="区域特定货币"><a href="#区域特定货币" class="headerlink" title="区域特定货币"></a>区域特定货币</h2><p>可以使用<code>java.text.NumberFormat</code>类和它的静态方法<code>getCurrencyInstance()</code>来格式化数字。比如在区域特定货币中的 long 型和 double 型。接下来的例子显示了如何根据指定的区域来格式化货币：</p>
<h2 id="区域特定百分比"><a href="#区域特定百分比" class="headerlink" title="区域特定百分比"></a>区域特定百分比</h2><p>可以使用<code>java.text.NumberFormat</code>类和它的静态方法<code>getPercentInstance()</code>来格式化百分比。接下来的例子告诉我们如何根据指定的区域来格式化百分比：</p>
<h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><p>参考代码见：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">javaee-notes\javaee-jsp\src\main\webapp\examples\locale</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dunwu.github.io/blog/2017/11/08/programming/java/javaweb/javaee/jsp/jsp-introduction/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zhang Peng">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="张鹏的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/2017/11/08/programming/java/javaweb/javaee/jsp/jsp-introduction/" itemprop="url">JSP 概述</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-11-08T00:00:00+08:00">
                2017-11-08
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/javaee/" itemprop="url" rel="index">
                    <span itemprop="name">javaee</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="什么是-Java-Server-Pages"><a href="#什么是-Java-Server-Pages" class="headerlink" title="什么是 Java Server Pages?"></a>什么是 Java Server Pages?</h2><p><code>JSP</code>全称<code>Java Server Pages</code>，是一种动态网页开发技术。</p>
<p>它使用 JSP 标签在 HTML 网页中插入 Java 代码。标签通常以<code>&lt;%</code>开头以<code>%&gt;</code>结束。</p>
<p>JSP 是一种 Java servlet，主要用于实现 Java web 应用程序的用户界面部分。网页开发者们通过结合 HTML 代码、XHTML 代码、XML 元素以及嵌入 JSP 操作和命令来编写 JSP。</p>
<p>JSP 通过网页表单获取用户输入数据、访问数据库及其他数据源，然后动态地创建网页。</p>
<p>JSP 标签有多种功能，比如访问数据库、记录用户选择信息、访问 JavaBeans 组件等，还可以在不同的网页中传递控制信息和共享信息。</p>
<h2 id="为什么使用-JSP？"><a href="#为什么使用-JSP？" class="headerlink" title="为什么使用 JSP？"></a>为什么使用 JSP？</h2><p>JSP 也是一种 Servlet，因此 JSP 能够完成 Servlet 能完成的任何工作。</p>
<p>JSP 程序与 CGI 程序有着相似的功能，但和 CGI 程序相比，JSP 程序有如下优势：</p>
<ul>
<li>性能更加优越，因为 JSP 可以直接在 HTML 网页中动态嵌入元素而不需要单独引用 CGI 文件。</li>
<li>服务器调用的是已经编译好的 JSP 文件，而不像 CGI/Perl 那样必须先载入解释器和目标脚本。</li>
<li>JSP 基于 Java Servlets API，因此，JSP 拥有各种强大的企业级 Java API，包括 JDBC，JNDI，EJB，JAXP 等等。</li>
<li>JSP 页面可以与处理业务逻辑的 servlets 一起使用，这种模式被 Java servlet 模板引擎所支持。</li>
</ul>
<p>最后，JSP 是 Java EE 不可或缺的一部分，是一个完整的企业级应用平台。这意味着 JSP 可以用最简单的方式来实现最复杂的应用。</p>
<h2 id="JSP-的优势"><a href="#JSP-的优势" class="headerlink" title="JSP 的优势"></a>JSP 的优势</h2><p>以下列出了使用 JSP 带来的其他好处：</p>
<ul>
<li>与 ASP 相比：JSP 有两大优势。首先，动态部分用 Java 编写，而不是 VB 或其他 MS 专用语言，所以更加强大与易用。第二点就是 JSP 易于移植到非 MS 平台上。</li>
<li>与纯 Servlets 相比：JSP 可以很方便的编写或者修改 HTML 网页而不用去面对大量的 println 语句。</li>
<li>与 SSI 相比：SSI 无法使用表单数据、无法进行数据库链接。</li>
<li>与 JavaScript 相比：虽然 JavaScript 可以在客户端动态生成 HTML，但是很难与服务器交互，因此不能提供复杂的服务，比如访问数据库和图像处理等等。</li>
<li>与静态 HTML 相比：静态 HTML 不包含动态信息。</li>
</ul>
<h1 id="JSP-工作原理"><a href="#JSP-工作原理" class="headerlink" title="JSP 工作原理"></a>JSP 工作原理</h1><p><strong>JSP 是一种 Servlet</strong>，但工作方式和 Servlet 有所差别。</p>
<p>Servlet 是先将源代码编译为 class 文件后部署到服务器下的，<strong>先编译后部署</strong>。</p>
<p>Jsp 是先将源代码部署到服务器再编译，<strong>先部署后编译</strong>。</p>
<p>Jsp 会在客户端第一次请求 Jsp 文件时被编译为 HttpJspPage 类（Servlet 的一个子类）。该类会被服务器临时存放在服务器工作目录里。所以，第一次请求 Jsp 后，访问速度会变快就是这个道理。</p>
<h2 id="JSP-工作流程"><a href="#JSP-工作流程" class="headerlink" title="JSP 工作流程"></a>JSP 工作流程</h2><p>网络服务器需要一个 JSP 引擎，也就是一个容器来处理 JSP 页面。容器负责截获对 JSP 页面的请求。本教程使用内嵌 JSP 容器的 Apache 来支持 JSP 开发。</p>
<p>JSP 容器与 Web 服务器协同合作，为 JSP 的正常运行提供必要的运行环境和其他服务，并且能够正确识别专属于 JSP 网页的特殊元素。</p>
<p>下图显示了 JSP 容器和 JSP 文件在 Web 应用中所处的位置。</p>
<p><br><div align="center"><img src="http://www.runoob.com/wp-content/uploads/2014/01/jsp-arch.jpg"></div><br></p>
<h3 id="工作步骤"><a href="#工作步骤" class="headerlink" title="工作步骤"></a>工作步骤</h3><p>以下步骤表明了 Web 服务器是如何使用 JSP 来创建网页的：</p>
<ul>
<li>就像其他普通的网页一样，您的浏览器发送一个 HTTP 请求给服务器。</li>
<li>Web 服务器识别出这是一个对 JSP 网页的请求，并且将该请求传递给 JSP 引擎。通过使用 URL 或者.jsp 文件来完成。</li>
<li>JSP 引擎从磁盘中载入 JSP 文件，然后将它们转化为 servlet。这种转化只是简单地将所有模板文本改用 println()语句，并且将所有的 JSP 元素转化成 Java 代码。</li>
<li>JSP 引擎将 servlet 编译成可执行类，并且将原始请求传递给 servlet 引擎。</li>
<li>Web 服务器的某组件将会调用 servlet 引擎，然后载入并执行 servlet 类。在执行过程中，servlet 产生 HTML 格式的输出并将其内嵌于 HTTP response 中上交给 Web 服务器。</li>
<li>Web 服务器以静态 HTML 网页的形式将 HTTP response 返回到您的浏览器中。</li>
<li>最终，Web 浏览器处理 HTTP response 中动态产生的 HTML 网页，就好像在处理静态网页一样。</li>
</ul>
<p>以上提及到的步骤可以用下图来表示：</p>
<p>一般情况下，JSP 引擎会检查 JSP 文件对应的 servlet 是否已经存在，并且检查 JSP 文件的修改日期是否早于 servlet。如果 JSP 文件的修改日期早于对应的 servlet，那么容器就可以确定 JSP 文件没有被修改过并且 servlet 有效。这使得整个流程与其他脚本语言（比如 PHP）相比要高效快捷一些。</p>
<h1 id="JSP-生命周期"><a href="#JSP-生命周期" class="headerlink" title="JSP  生命周期"></a>JSP  生命周期</h1><p>理解 JSP 底层功能的关键就是去理解它们所遵守的生命周期。</p>
<p>JSP 生命周期就是从创建到销毁的整个过程，类似于 servlet 生命周期，区别在于 JSP 生命周期还包括将 JSP 文件编译成 servlet。</p>
<p>以下是 JSP 生命周期中所走过的几个阶段：</p>
<ul>
<li><strong>编译阶段：</strong>servlet 容器编译 servlet 源文件，生成 servlet 类</li>
<li><strong>初始化阶段：</strong>加载与 JSP 对应的 servlet 类，创建其实例，并调用它的初始化方法</li>
<li><strong>执行阶段：</strong>调用与 JSP 对应的 servlet 实例的服务方法</li>
<li><strong>销毁阶段：</strong>调用与 JSP 对应的 servlet 实例的销毁方法，然后销毁 servlet 实例</li>
</ul>
<p>很明显，JSP 生命周期的四个主要阶段和 servlet 生命周期非常相似，下面给出图示：</p>
<p><br><div align="center"><img src="http://www.runoob.com/wp-content/uploads/2014/01/jsp_life_cycle.jpg"></div><br></p>
<h2 id="JSP-编译"><a href="#JSP-编译" class="headerlink" title="JSP 编译"></a>JSP 编译</h2><p>当浏览器请求 JSP 页面时，JSP 引擎会首先去检查是否需要编译这个文件。如果这个文件没有被编译过，或者在上次编译后被更改过，则编译这个 JSP 文件。</p>
<p>编译的过程包括三个步骤：</p>
<ul>
<li>解析 JSP 文件。</li>
<li>将 JSP 文件转为 servlet。</li>
<li>编译 servlet。</li>
</ul>
<h2 id="JSP-初始化"><a href="#JSP-初始化" class="headerlink" title="JSP 初始化"></a>JSP 初始化</h2><p>容器载入 JSP 文件后，它会在为请求提供任何服务前调用 jspInit()方法。如果您需要执行自定义的 JSP 初始化任务，复写 jspInit()方法就行了，就像下面这样：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">public void jspInit()&#123;</span><br><span class="line">  // 初始化代码</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>一般来讲程序只初始化一次，servlet 也是如此。通常情况下您可以在 jspInit()方法中初始化数据库连接、打开文件和创建查询表。</p>
<h2 id="JSP-执行"><a href="#JSP-执行" class="headerlink" title="JSP 执行"></a>JSP 执行</h2><p>这一阶段描述了 JSP 生命周期中一切与请求相关的交互行为，直到被销毁。</p>
<p>当 JSP 网页完成初始化后，JSP 引擎将会调用_jspService()方法。</p>
<p>_jspService()方法需要一个 HttpServletRequest 对象和一个 HttpServletResponse 对象作为它的参数，就像下面这样：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">void _jspService(HttpServletRequest request,</span><br><span class="line">                 HttpServletResponse response)</span><br><span class="line">&#123;</span><br><span class="line">   // 服务端处理代码</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>_jspService()方法在每个 request 中被调用一次并且负责产生与之相对应的 response，并且它还负责产生所有 7 个 HTTP 方法的回应，比如 GET、POST、DELETE 等等。</p>
<h2 id="JSP-清理"><a href="#JSP-清理" class="headerlink" title="JSP 清理"></a>JSP 清理</h2><p>JSP 生命周期的销毁阶段描述了当一个 JSP 网页从容器中被移除时所发生的一切。</p>
<p>jspDestroy()方法在 JSP 中等价于 servlet 中的销毁方法。当您需要执行任何清理工作时复写 jspDestroy()方法，比如释放数据库连接或者关闭文件夹等等。</p>
<p>jspDestroy()方法的格式如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public void jspDestroy()</span><br><span class="line">&#123;</span><br><span class="line">   // 清理代码</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dunwu.github.io/blog/2017/11/08/programming/java/javaweb/javaee/jsp/jsp-implicit-objects/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zhang Peng">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="张鹏的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/2017/11/08/programming/java/javaweb/javaee/jsp/jsp-implicit-objects/" itemprop="url">JSP 隐式对象</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-11-08T00:00:00+08:00">
                2017-11-08
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/javaee/" itemprop="url" rel="index">
                    <span itemprop="name">javaee</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>JSP 隐式对象是 JSP 容器为每个页面提供的 Java 对象，开发者可以直接使用它们而不用显式声明。JSP 隐式对象也被称为预定义变量。</p>
<p>JSP 所支持的九大隐式对象：</p>
<table>
<thead>
<tr>
<th><strong>对象</strong></th>
<th><strong>描述</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>request</td>
<td><strong>HttpServletRequest</strong>类的实例</td>
</tr>
<tr>
<td>response</td>
<td><strong>HttpServletResponse</strong>类的实例</td>
</tr>
<tr>
<td>out</td>
<td><strong>PrintWriter</strong>类的实例，用于把结果输出至网页上</td>
</tr>
<tr>
<td>session</td>
<td><strong>HttpSession</strong>类的实例</td>
</tr>
<tr>
<td>application</td>
<td><strong>ServletContext</strong>类的实例，与应用上下文有关</td>
</tr>
<tr>
<td>config</td>
<td><strong>ServletConfig</strong>类的实例</td>
</tr>
<tr>
<td>pageContext</td>
<td><strong>PageContext</strong>类的实例，提供对 JSP 页面所有对象以及命名空间的访问</td>
</tr>
<tr>
<td>page</td>
<td>类似于 Java 类中的 this 关键字</td>
</tr>
<tr>
<td>Exception</td>
<td><strong>Exception</strong>类的对象，代表发生错误的 JSP 页面中对应的异常对象</td>
</tr>
</tbody>
</table>
<h2 id="request-对象"><a href="#request-对象" class="headerlink" title="request 对象"></a>request 对象</h2><p><code>request</code>对象是<code>javax.servlet.http.HttpServletRequest</code> 类的实例。</p>
<p>每当客户端请求一个 JSP 页面时，JSP 引擎就会制造一个新的<code>request</code>对象来代表这个请求。</p>
<p><code>request</code>对象提供了一系列方法来获取 HTTP 头信息，cookies，HTTP 方法等等。</p>
<h2 id="response-对象"><a href="#response-对象" class="headerlink" title="response 对象"></a>response 对象</h2><p><code>response</code>对象是<code>javax.servlet.http.HttpServletResponse</code>类的实例。</p>
<p>当服务器创建<code>request</code>对象时会同时创建用于响应这个客户端的<code>response</code>对象。</p>
<p><code>response</code>对象也定义了处理 HTTP 头模块的接口。通过这个对象，开发者们可以添加新的 cookies，时间戳，HTTP 状态码等等。</p>
<h2 id="out-对象"><a href="#out-对象" class="headerlink" title="out 对象"></a>out 对象</h2><p><code>out</code>对象是<code>javax.servlet.jsp.JspWriter</code>类的实例，用来在<code>response</code>对象中写入内容。</p>
<p>最初的<code>JspWriter</code>类对象根据页面是否有缓存来进行不同的实例化操作。可以在<code>page</code>指令中使用<code>buffered=&#39;false&#39;</code>属性来轻松关闭缓存。</p>
<p><code>JspWriter</code>类包含了大部分<code>java.io.PrintWriter</code>类中的方法。不过，<code>JspWriter</code>新增了一些专为处理缓存而设计的方法。还有就是，<code>JspWriter</code>类会抛出<code>IOExceptions</code>异常，而<code>PrintWriter</code>不会。</p>
<p>下表列出了我们将会用来输出<code>boolean</code>，<code>char</code>，<code>int</code>，<code>double</code>，<code>String</code>，<code>object</code>等类型数据的重要方法：</p>
<table>
<thead>
<tr>
<th><strong>方法</strong></th>
<th><strong>描述</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>out.print(dataType dt)</strong></td>
<td>输出 Type 类型的值</td>
</tr>
<tr>
<td><strong>out.println(dataType dt)</strong></td>
<td>输出 Type 类型的值然后换行</td>
</tr>
<tr>
<td><strong>out.flush()</strong></td>
<td>刷新输出流</td>
</tr>
</tbody>
</table>
<h2 id="session-对象"><a href="#session-对象" class="headerlink" title="session 对象"></a>session 对象</h2><p><code>session</code>对象是<code>javax.servlet.http.HttpSession</code>类的实例。和 Java Servlets 中的<code>session</code>对象有一样的行为。</p>
<p><code>session</code>对象用来跟踪在各个客户端请求间的会话。</p>
<h2 id="application-对象"><a href="#application-对象" class="headerlink" title="application 对象"></a>application 对象</h2><p><code>application</code>对象直接包装了 servlet 的<code>ServletContext</code>类的对象，是<code>javax.servlet.ServletContext</code>类的实例。</p>
<p>这个对象在 JSP 页面的整个生命周期中都代表着这个 JSP 页面。这个对象在 JSP 页面初始化时被创建，随着<code>jspDestroy()</code>方法的调用而被移除。</p>
<p>通过向<code>application</code>中添加属性，则所有组成您 web 应用的 JSP 文件都能访问到这些属性。</p>
<h2 id="config-对象"><a href="#config-对象" class="headerlink" title="config 对象"></a>config 对象</h2><p><code>config</code>对象是<code>javax.servlet.ServletConfig</code>类的实例，直接包装了 servlet 的<code>ServletConfig</code>类的对象。</p>
<p>这个对象允许开发者访问 Servlet 或者 JSP 引擎的初始化参数，比如文件路径等。</p>
<p>以下是 config 对象的使用方法，不是很重要，所以不常用：</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">config.getServletName();</span><br></pre></td></tr></table></figure>
<p>它返回包含在<code>&lt;servlet-name&gt;</code>元素中的 servlet 名字，注意，<code>&lt;servlet-name&gt;</code>元素在<code>WEB-INF\web.xml</code>文件中定义。</p>
<h2 id="pageContext-对象"><a href="#pageContext-对象" class="headerlink" title="pageContext 对象"></a>pageContext 对象</h2><p><code>pageContext</code>对象是<code>javax.servlet.jsp.PageContext</code>类的实例，用来代表整个 JSP 页面。</p>
<p>这个对象主要用来访问页面信息，同时过滤掉大部分实现细节。</p>
<p>这个对象存储了<code>request</code>对象和<code>response</code>对象的引用。<code>application</code>对象，<code>config</code>对象，<code>session</code>对象，<code>out</code>对象可以通过访问这个对象的属性来导出。</p>
<p><code>pageContext</code>对象也包含了传给 JSP 页面的指令信息，包括缓存信息，ErrorPage URL,页面 scope 等。</p>
<p><code>PageContext</code>类定义了一些字段，包括 PAGE_SCOPE，REQUEST_SCOPE，SESSION_SCOPE， APPLICATION_SCOPE。它也提供了 40 余种方法，有一半继承自<code>javax.servlet.jsp.JspContext</code> 类。</p>
<p>其中一个重要的方法就是<code>removeArribute()</code>，它可接受一个或两个参数。比如，pageContext.removeArribute(“attrName”)移除四个 scope 中相关属性，但是下面这种方法只移除特定 scope 中的相关属性：</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pageContext.removeAttribute(<span class="string">"attrName"</span>, PAGE_SCOPE);</span><br></pre></td></tr></table></figure>
<h2 id="page-对象"><a href="#page-对象" class="headerlink" title="page 对象"></a>page 对象</h2><p>这个对象就是页面实例的引用。它可以被看做是整个 JSP 页面的代表。</p>
<p><code>page</code>对象就是<code>this</code>对象的同义词。</p>
<h2 id="exception-对象"><a href="#exception-对象" class="headerlink" title="exception 对象"></a>exception 对象</h2><p><code>exception</code>对象包装了从先前页面中抛出的异常信息。它通常被用来产生对出错条件的适当响应。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/blog/page/33/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/blog/">1</a><span class="space">&hellip;</span><a class="page-number" href="/blog/page/33/">33</a><span class="page-number current">34</span><a class="page-number" href="/blog/page/35/">35</a><span class="space">&hellip;</span><a class="page-number" href="/blog/page/39/">39</a><a class="extend next" rel="next" href="/blog/page/35/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/blog/images/avatar.gif" alt="Zhang Peng">
            
              <p class="site-author-name" itemprop="name">Zhang Peng</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/blog/archives/">
              
                  <span class="site-state-item-count">381</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/blog/categories/index.html">
                  <span class="site-state-item-count">14</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/blog/tags/index.html">
                  <span class="site-state-item-count">76</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/blog/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/dunwu" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:forbreak@163.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2015 &mdash; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-paper-plane"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Zhang Peng</span>

  
</div>









        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/blog/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/blog/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/blog/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/blog/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/blog/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/blog/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/blog/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/blog/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/blog/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/blog/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/blog/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === '') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  

  

  

</body>
</html>
